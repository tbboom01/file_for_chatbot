/*! For license information please see index.js.LICENSE.txt */
(()=>{var t,e,n={492:t=>{function e(t,e){return Object.keys(e).forEach((function(n){"default"===n||"__esModule"===n||t.hasOwnProperty(n)||Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[n]}})})),t}function n(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}n(t.exports,"utils",(()=>i));var i={},o={};function r(t){return new Promise((e=>setTimeout((()=>e()),t)))}n(o,"delay",(()=>r));var s={};function a(){const t=new URLSearchParams(window.location.search.substring(1));return Boolean(t.get("adengine_debug"))?t.get("adengine_debug"):t.get("identity_debug")}n(s,"getDebugGroup",(()=>a));var c={};n(c,"localStorageHelper",(()=>u));class u{constructor(t,e=6e4){this.key=t,this.ttlInMilliseconds=e;let n=!1;try{n=void 0!==window.localStorage&&null!==window.localStorage,n&&(window.localStorage.setItem("__test__","test"),window.localStorage.removeItem("__test__"))}catch(t){n=!1}const i=t=>window?.instantConfigCache?.[t]??null,o=(t,e)=>{void 0===window.instantConfigCache&&(window.instantConfigCache={}),window.instantConfigCache[t]=e};this.storageAdapter={getItem:t=>{try{return n?window.localStorage.getItem(t)??i(t):i(t)}catch(e){return i(t)}},setItem:(t,e)=>{try{if(n)return localStorage.setItem(t,e);o(t,e)}catch(n){o(t,e)}}}}set(t){const e=this.getObjectToStore(t);this.storageAdapter.setItem(this.key,JSON.stringify(e))}get(){const t=this.storageAdapter.getItem(this.key);return t?this.parseStoredValue(JSON.parse(t)):null}expired(t){return!t||t<Date.now()}getObjectToStore(t){return{data:t,ttl:Date.now()+this.ttlInMilliseconds}}parseStoredValue(t){return this.expired(t?.ttl)?null:t.data}}var d={};n(d,"lock",(()=>f)),n(d,"release",(()=>h));const l=new u("instant-config-lock",1e3);function f(){return"lock"===l.get()||(l.set("lock"),!1)}function h(){l.set(null)}var p={};n(p,"getTimeDelta",(()=>m)),n(p,"logger",(()=>w)),n(p,"warner",(()=>b));const g=a()||"",v=g.split(","),y=Date.now();function m(){return((Date.now()-(window.performance?.timeOrigin??y))/1e3).toFixed(4)}function w(t,...e){""!==g&&("1"!==g&&-1===v.indexOf(t)||window.console.info(`${m()}s\t\t ${t}`,e))}function b(t,...e){""!==g&&("1"!==g&&-1===v.indexOf(t)||window.console.warn(t,e))}e(i,o),e(i,s),e(i,c),e(i,d),e(i,p);var C={},k={};n(k,"EmptyInstantConfigCacheStorage",(()=>S));class S{get(t){}set(t){}}var O={};n(O,"InstantConfigInterpreter",(()=>z));var _={},M={};n(M,"BrowserMatcher",(()=>G));var j={};n(j,"extractNegation",(()=>N));var I={},T={};function E(t){return Array.isArray(t)&&t.length>0&&"object"==typeof t[0]}n(T,"shouldBeListOfConfigGroups",(()=>E));var x={};n(x,"negativePrefix",(()=>P)),n(x,"cacheSuffix",(()=>R)),n(x,"samplingSeparator",(()=>D)),n(x,"worldWide",(()=>L)),n(x,"precision",(()=>A));const P="non-",R="-cached",D="/",L="XX",A=10**6;function N(t){return t.startsWith(P)?{value:t.replace(P,""),negated:!0}:{value:t,negated:!1}}e(I,{}),e(I,{}),e(I,{}),e(I,T),e(I,{}),e(I,{}),e(I,{}),e(I,{}),e(I,{}),e(I,x);class G{constructor(t){this.currentBrowser=t?.toLowerCase()}isValid(t=[]){const e=t.map((t=>t.toLowerCase())).map((t=>N(t)));return 0===t.length||!this.currentBrowser||!this.isCurrentNegated(this.currentBrowser,e)&&e.some((t=>this.currentBrowser.includes(t.value)!==t.negated))}isCurrentNegated(t,e){return e.some((e=>t.includes(e.value)&&e.negated))}}var U={};n(U,"DeviceMatcher",(()=>W));class W{constructor(t){this.currentDevice=t}isValid(t=[]){const e=t.map((t=>t.toLowerCase())).map((t=>N(t)));return 0===e.length||!this.currentDevice||!this.isCurrentNegated(this.currentDevice,e)&&e.some((t=>t.value===this.currentDevice!==t.negated))}isCurrentNegated(t,e){return e.some((e=>t.includes(e.value)&&e.negated))}}var Y={};n(Y,"DomainMatcher",(()=>H));class H{isValid(t=[]){return 0===t.length||t.some((t=>window.location.hostname.includes(t)))}}var $={};n($,"RegionMatcher",(()=>F));class F{constructor(t){this.geo=t}isValid(t=[],e){const n=this.filterOutInvalidRegions(t);return e?e(n):this.isProperGeo(n)}getCountryCode(){return this.geo?.country}getRegionCode(){return this.geo?.region}getContinentCode(){return this.geo?.continent}isProperGeo(t=[]){return!(!t||!t.indexOf||this.isGeoExcluded(t)||!(this.isProperContinent(t)||this.isProperCountry(t)||this.isProperRegion(t)))}filterOutInvalidRegions(t){return t.filter((t=>!t.includes(D))).filter((t=>!t.includes(R)))}isProperCountry(t){return!!(t&&t.indexOf&&(t.indexOf(this.getCountryCode())>-1||this.isSampledForGeo(t,this.getCountryCode())))}isProperRegion(t){const e=`${this.getCountryCode()}-${this.getRegionCode()}`;return!!(t&&t.indexOf&&(t.indexOf(e)>-1||this.isSampledForGeo(t,e)))}containsContinent(t){const e=`${L}-${this.getContinentCode()}`;return t.indexOf(e)>-1||this.isSampledForGeo(t,e)}containsWorldWide(t){return t.indexOf(L)>-1||this.isSampledForGeo(t,L)}isProperContinent(t){return!(!t||!t.indexOf||!this.containsWorldWide(t)&&!this.containsContinent(t))}isGeoExcluded(t){return!!(t.indexOf(`${P}${this.getCountryCode()}`)>-1||t.indexOf(`${P}${this.getCountryCode()}-${this.getRegionCode()}`)>-1||t.indexOf(`${P}${L}-${this.getContinentCode()}`)>-1)}hasSampling(t){return e=>0!==e.indexOf(P)&&e.indexOf(t+D)>-1}getSamplingLimits(t){let[,e]=t.split(D);return e=e.replace(R,""),Math.round(parseFloat(e)*A)||0}isSampledForGeo(t,e){const n=t.filter(this.hasSampling(e));if(0===n.length)return!1;const i=Math.round(Math.random()*(100*A))||0;return n.map((t=>this.getSamplingLimits(t))).some((t=>i<t))}}var V={};n(V,"SamplingCacheManager",(()=>B));class B{constructor(t){this.cacheStorage=t,this.precision=10**6}apply(t,e,n){const i=this.cacheStorage.get(t);if(void 0!==i)return i.result;const o=n();if("number"!=typeof e.sampling||!1===o)return o;const r=this.getSamplingResult(e.sampling),s={name:t,result:r,withCookie:Boolean(e.samplingCache),group:r?"B":"A",limit:+(r?e.sampling:100-e.sampling).toFixed(6)};return this.cacheStorage.set(s),r}getSamplingResult(t){const e=Math.round(100*Math.random()*this.precision);return Math.round(t*this.precision)>e}}e(_,M),e(_,U),e(_,Y),e(_,j),e(_,$),e(_,V);class z{constructor(t=new G,e=new W,n=new H,i=new F,o=new S){this.browserMatcher=t,this.deviceMatcher=e,this.domainMatcher=n,this.regionMatcher=i,this.instantConfigCacheService=o,this.logGroup="instant-config-interpreter",this.configResponse={},this.samplingCache=new B(o)}init(t,e={},n){return this.configResponse={...e,...t},this.regionValidationPredicate=n,this}getValues(){return i.logger(this.logGroup,"get values called with",this.configResponse),Object.keys(this.configResponse).map((t=>({key:t,value:this.configResponse[t]}))).map((({key:t,value:e})=>E(e)?{key:t,value:this.getValue(t,e)}:{key:t,value:e})).reduce(((t,e)=>({...t,[e.key]:e.value})),{})}getValue(t,e){const n=e.find(((e,n)=>this.samplingCache.apply(`${t}-${n}`,e,this.getPredicate(e))));if(void 0!==n)return n.value}getPredicate(t){return()=>this.browserMatcher.isValid(t.browsers)&&this.deviceMatcher.isValid(t.devices)&&this.domainMatcher.isValid(t.domains)&&this.regionMatcher.isValid(t.regions,this.regionValidationPredicate)}}var q={};async function X(t,e=2e3){const n=new AbortController,i=setTimeout((()=>n.abort()),e),o=await fetch(t,{signal:n.signal});return clearTimeout(i),o}n(q,"InstantConfigLoader",(()=>Z));const K="instant-config-loader",J="instantConfig",Q={b:"browsers",d:"devices",s:"sampling",c:"samplingCache",r:"regions",v:"value"};class Z{constructor(t,e=window){this.params=t,this.configPromise=null,this.storage=new i.localStorageHelper(`instant-config-${t.appName}`,6e4),this.instantConfig=this.fromContainer(e)}async getConfig(){return this.instantConfig?this.instantConfig:(this.configPromise||(this.configPromise=this.fetchInstantConfig().then((t=>t??this.fetchFallbackConfig()))),this.configPromise.then((t=>t)))}async fetchInstantConfig(t=!1){if(i.lock()&&!t)return await r(500),this.fetchInstantConfig(!0);const e=`${this.params.instantConfigEndpoint??"https://services.fandom.com"}/${this.params.instantConfigVariant??"icbm"}/api/config?app=${this.params.appName}`;try{const t=this.storage.get();if(t)return i.logger(K,"instant config pulled from local storage",t),JSON.parse(t);const n=await X(e,this.params.requestTimeout);if(!n.ok)return;const o=await n.json();return this.storage.set(JSON.stringify(o)),i.release(),i.logger(K,"instant config fetched",o),o}catch(t){return i.warner(K,"could not fetch instant config",t),void i.release()}}async fetchFallbackConfig(){i.logger(K,"Fetching fallback config");const t=this.params.instantConfigFallbackEndpoint;if(void 0===t)return{};try{i.logger(K,t);const e=await X(t,this.params.requestTimeout);if(!e.ok)return{};const n=await e.json();return i.logger(K,"fallback config fetched",n),n}catch(t){return i.warner(K,"could not fetch fallback config",t),{}}}fromContainer(t){let e=t[J];return"object"!=typeof e||e._ready||(Object.keys(e).forEach((t=>{const n=e[t];E(n)&&(e[t]=n.map((t=>Object.fromEntries(Object.entries(t).map((([t,e])=>[Q[t]?Q[t]:t,e]))))))})),e._ready=!0,t[J]=e),e}}var tt={};n(tt,"InstantConfigOverrider",(()=>nt));const et=["InstantGlobals","icbm"];class nt{override(t,e){return[...t.keys()].filter((t=>{return e=t,et.some((t=>e.startsWith(`${t}.`)||e.startsWith(`${t}__`)));var e})).map((t=>{const[,e]=t.split(".").map((t=>t.split("__"))).flat();return{paramKey:t,key:e}})).map((({paramKey:e,key:n})=>({key:n,value:this.parseValue(t.get(e))}))).reduce(((t,{key:e,value:n})=>({...t,[e]:n})),e)}parseValue(t){if("true"===t||"false"===t)return"true"===t;const e=parseInt(t,10);if(t===`${e}`)return e;try{return JSON.parse(t)}catch(e){return t||null}}}e(C,k),e(C,O),e(C,q),e(C,tt),e(C,_),e(t.exports,C),e(t.exports,I)},155:t=>{var e,n,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{n="function"==typeof clearTimeout?clearTimeout:r}catch(t){n=r}}();var a,c=[],u=!1,d=-1;function l(){u&&a&&(u=!1,a.length?c=a.concat(c):d=-1,c.length&&f())}function f(){if(!u){var t=s(l);u=!0;for(var e=c.length;e;){for(a=c,c=[];++d<e;)a&&a[d].run();d=-1,e=c.length}a=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===r||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{return n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function p(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new h(t,e)),1!==c.length||u||s(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},660:(t,e,n)=>{var i,o=n(155);!function(t){!function(e){var i="object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=s(t);function s(t,e){return function(n,i){"function"!=typeof t[n]&&Object.defineProperty(t,n,{configurable:!0,writable:!0,value:i}),e&&e(n,i)}}void 0===i.Reflect?i.Reflect=t:r=s(i.Reflect,r),function(t){var e=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",r=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,a={__proto__:[]}instanceof Array,c=!s&&!a,u={create:s?function(){return A(Object.create(null))}:a?function(){return A({__proto__:null})}:function(){return A({})},has:c?function(t,n){return e.call(t,n)}:function(t,e){return e in t},get:c?function(t,n){return e.call(t,n)?t[n]:void 0}:function(t,e){return t[e]}},d=Object.getPrototypeOf(Function),l="object"==typeof o&&o.env&&"true"===o.env.REFLECT_METADATA_USE_MAP_POLYFILL,f=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var t={},e=[],n=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[r]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var n=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var n=this._find(t,!0);return this._values[n]=e,this},e.prototype.delete=function(e){var n=this._find(e,!1);if(n>=0){for(var i=this._keys.length,o=n+1;o<i;o++)this._keys[o-1]=this._keys[o],this._values[o-1]=this._values[o];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new n(this._keys,this._values,i)},e.prototype.values=function(){return new n(this._keys,this._values,o)},e.prototype.entries=function(){return new n(this._keys,this._values,s)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[r]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function i(t,e){return t}function o(t,e){return e}function s(t,e){return[t,e]}}():Map,h=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new f}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[r]=function(){return this.keys()},t}():Set,p=new(l||"function"!=typeof WeakMap?function(){var t=16,n=u.create(),i=o();return function(){function t(){this._key=o()}return t.prototype.has=function(t){var e=r(t,!1);return void 0!==e&&u.has(e,this._key)},t.prototype.get=function(t){var e=r(t,!1);return void 0!==e?u.get(e,this._key):void 0},t.prototype.set=function(t,e){return r(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=r(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=o()},t}();function o(){var t;do{t="@@WeakMap@@"+a()}while(u.has(n,t));return n[t]=!0,t}function r(t,n){if(!e.call(t,i)){if(!n)return;Object.defineProperty(t,i,{value:u.create()})}return t[i]}function s(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}function a(){var e,n=(e=t,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e));n[6]=79&n[6]|64,n[8]=191&n[8]|128;for(var i="",o=0;o<t;++o){var r=n[o];4!==o&&6!==o&&8!==o||(i+="-"),r<16&&(i+="0"),i+=r.toString(16).toLowerCase()}return i}}():WeakMap);function g(t,e,n){var i=p.get(t);if(O(i)){if(!n)return;i=new f,p.set(t,i)}var o=i.get(e);if(O(o)){if(!n)return;o=new f,i.set(e,o)}return o}function v(t,e,n){if(y(t,e,n))return!0;var i=L(e);return!_(i)&&v(t,i,n)}function y(t,e,n){var i=g(e,n,!1);return!O(i)&&!!i.has(t)}function m(t,e,n){if(y(t,e,n))return w(t,e,n);var i=L(e);return _(i)?void 0:m(t,i,n)}function w(t,e,n){var i=g(e,n,!1);if(!O(i))return i.get(t)}function b(t,e,n,i){g(n,i,!0).set(t,e)}function C(t,e){var n=k(t,e),i=L(t);if(null===i)return n;var o=C(i,e);if(o.length<=0)return n;if(n.length<=0)return o;for(var r=new h,s=[],a=0,c=n;a<c.length;a++){var u=c[a];r.has(u)||(r.add(u),s.push(u))}for(var d=0,l=o;d<l.length;d++)u=l[d],r.has(u)||(r.add(u),s.push(u));return s}function k(t,e){var n=[],i=g(t,e,!1);if(O(i))return n;for(var o=function(t){var e=P(t,r);if(!E(e))throw new TypeError;var n=e.call(t);if(!M(n))throw new TypeError;return n}(i.keys()),s=0;;){var a=R(o);if(!a)return n.length=s,n;var c=a.value;try{n[s]=c}catch(t){try{D(o)}finally{throw t}}s++}}function S(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function O(t){return void 0===t}function _(t){return null===t}function M(t){return"object"==typeof t?null!==t:"function"==typeof t}function j(t,e){switch(S(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",o=P(t,i);if(void 0!==o){var r=o.call(t,n);if(M(r))throw new TypeError;return r}return function(t,e){if("string"===e){var n=t.toString;if(E(n)&&!M(o=n.call(t)))return o;if(E(i=t.valueOf)&&!M(o=i.call(t)))return o}else{var i;if(E(i=t.valueOf)&&!M(o=i.call(t)))return o;var o,r=t.toString;if(E(r)&&!M(o=r.call(t)))return o}throw new TypeError}(t,"default"===n?"number":n)}function I(t){var e=j(t,3);return"symbol"==typeof e?e:function(t){return""+t}(e)}function T(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function E(t){return"function"==typeof t}function x(t){return"function"==typeof t}function P(t,e){var n=t[e];if(null!=n){if(!E(n))throw new TypeError;return n}}function R(t){var e=t.next();return!e.done&&e}function D(t){var e=t.return;e&&e.call(t)}function L(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===d)return e;if(e!==d)return e;var n=t.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return e;var o=i.constructor;return"function"!=typeof o||o===t?e:o}function A(t){return t.__=void 0,delete t.__,t}t("decorate",(function(t,e,n,i){if(O(n)){if(!T(t))throw new TypeError;if(!x(e))throw new TypeError;return function(t,e){for(var n=t.length-1;n>=0;--n){var i=(0,t[n])(e);if(!O(i)&&!_(i)){if(!x(i))throw new TypeError;e=i}}return e}(t,e)}if(!T(t))throw new TypeError;if(!M(e))throw new TypeError;if(!M(i)&&!O(i)&&!_(i))throw new TypeError;return _(i)&&(i=void 0),function(t,e,n,i){for(var o=t.length-1;o>=0;--o){var r=(0,t[o])(e,n,i);if(!O(r)&&!_(r)){if(!M(r))throw new TypeError;i=r}}return i}(t,e,n=I(n),i)})),t("metadata",(function(t,e){return function(n,i){if(!M(n))throw new TypeError;if(!O(i)&&!function(t){switch(S(t)){case 3:case 4:return!0;default:return!1}}(i))throw new TypeError;b(t,e,n,i)}})),t("defineMetadata",(function(t,e,n,i){if(!M(n))throw new TypeError;return O(i)||(i=I(i)),b(t,e,n,i)})),t("hasMetadata",(function(t,e,n){if(!M(e))throw new TypeError;return O(n)||(n=I(n)),v(t,e,n)})),t("hasOwnMetadata",(function(t,e,n){if(!M(e))throw new TypeError;return O(n)||(n=I(n)),y(t,e,n)})),t("getMetadata",(function(t,e,n){if(!M(e))throw new TypeError;return O(n)||(n=I(n)),m(t,e,n)})),t("getOwnMetadata",(function(t,e,n){if(!M(e))throw new TypeError;return O(n)||(n=I(n)),w(t,e,n)})),t("getMetadataKeys",(function(t,e){if(!M(t))throw new TypeError;return O(e)||(e=I(e)),C(t,e)})),t("getOwnMetadataKeys",(function(t,e){if(!M(t))throw new TypeError;return O(e)||(e=I(e)),k(t,e)})),t("deleteMetadata",(function(t,e,n){if(!M(e))throw new TypeError;O(n)||(n=I(n));var i=g(e,n,!1);if(O(i))return!1;if(!i.delete(t))return!1;if(i.size>0)return!0;var o=p.get(e);return o.delete(n),o.size>0||p.delete(e),!0}))}(r)}()}(i||(i={}))},466:(t,e,n)=>{"use strict";n.d(e,{E9:()=>i,Nm:()=>s,hb:()=>r,m9:()=>o});const i=Symbol("COOKIES"),o=Symbol("WINDOW"),r=Symbol("UUID"),s=Symbol("SENTRY")},604:(t,e,n)=>{"use strict";n.d(e,{g:()=>r});var i=n(582),o=n(950);let r=class{createScript(t,e="text/javascript",n=!0,i=null,o={},r={}){const s=document.createElement("script");if(s.async=n,s.defer=!n,s.type=e,s.src=t,Object.keys(o).forEach((t=>{s.setAttribute(t,o[t])})),Object.keys(r).forEach((t=>{s.dataset[t]=r[t]})),"string"==typeof i){const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(s,t)}else(i||document.body).append(s);return s}loadScript(t,e="text/javascript",n=!0,i=null,o={},r={}){return new Promise(((s,a)=>{const c=this.createScript(t,e,n,i,o,r);c.onload=s,c.onerror=a}))}};r=(0,i.gn)([(0,o.b2)()],r)},162:(t,e,n)=>{"use strict";n.d(e,{a:()=>i});const i=["ai","aw","ax","at","be","bg","bm","vg","bq","ky","hr","cw","cy","cz","dk","ee","fk","fo","fi","fr","gf","pf","tf","de","gi","gr","gl","gp","hu","is","ie","im","it","re","lv","li","lt","lu","mq","mt","yt","ms","nl","nc","no","pn","pl","pt","ro","bl","sh","mf","pm","bq","sx","sk","si","es","se","ch","tc","gb","uk","wf","ad","br","cn"]},115:(t,e,n)=>{"use strict";n.d(e,{l:()=>l});var i,o,r,s=n(582),a=n(950),c=n(41),u=n(466),d=n(162);let l=class{constructor(t,e,n){this.cookiesManager=t,this.window=e,this.logger=n}get(){return this.geoData||(this.geoData=this.getGeoData()),this.geoData}set(t){this.geoData=t}getGeoData(){const t=this.getGeoDataFromCookie();return Object.keys(t).length?t:this.getGeoDataFromOneTrust()}getGeoDataFromCookie(){const t=this.cookiesManager.get("Geo");if(!t)return{};const e=decodeURIComponent(t);try{return JSON.parse(e)}catch(t){return this.logger.error("Invalid JSON in the cookie",t),{}}}getGeoDataFromOneTrust(){return this.window.OneTrust&&this.window.OneTrust.getGeolocationData()?{country:this.window.OneTrust.getGeolocationData().country}:{}}getCountryCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.country)||void 0===e?void 0:e.toLowerCase()}getRegionCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.region)||void 0===e?void 0:e.toLowerCase()}getContinentCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.continent)||void 0===e?void 0:e.toLowerCase()}isGdprCountry(){return d.a.includes(this.getCountryCode())}};l=(0,s.gn)([(0,a.ri)(),(0,s.fM)(0,(0,a.f3)(u.E9)),(0,s.fM)(1,(0,a.f3)(u.m9)),(0,s.fM)(2,(0,a.XH)(c.Y,c.d,"Geo")),(0,s.w6)("design:paramtypes",["function"==typeof(i="undefined"!=typeof CookiesManager&&CookiesManager)?i:Object,"function"==typeof(o="undefined"!=typeof Window&&Window)?o:Object,"function"==typeof(r=void 0!==c.Y&&c.Y)?r:Object])],l)},41:(t,e,n)=>{"use strict";n.d(e,{Y:()=>u,d:()=>c});var i,o=n(582),r=n(639),s=n(950),a=n(466);class c{transform(t,e){return t.setLoggerGroup(e)}}let u=class{constructor(t){var e,n;this.logGroup="Global",this.debugGroup=this.getDebugGroup()||"",this.groups=this.debugGroup.split(","),this.initTime=null!==(n=null===(e=null==t?void 0:t.performance)||void 0===e?void 0:e.timeOrigin)&&void 0!==n?n:Date.now()}setLoggerGroup(t){return this.logGroup=t,this}getTimeDelta(){return Date.now()-this.initTime}getDebugGroup(){return r.L.get("identity_debug")}getTimeDeltaFixed(){return(this.getTimeDelta()/1e3).toFixed(4)}info(...t){this.loggingEnabled()&&console.info(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}warn(...t){this.loggingEnabled()&&console.warn(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}error(...t){this.loggingEnabled()&&console.error(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}loggingEnabled(){return""!==this.debugGroup&&("1"===this.debugGroup||-1!==this.groups.indexOf(this.logGroup))}};u=(0,o.gn)([(0,s.b2)(),(0,o.fM)(0,(0,s.f3)(a.m9)),(0,o.w6)("design:paramtypes",["function"==typeof(i="undefined"!=typeof Window&&Window)?i:Object])],u)},639:(t,e,n)=>{"use strict";n.d(e,{L:()=>i});class i{static getURLSearchParams(){const t=window.location.search.substring(1);return new URLSearchParams(t)}static get(t){return i.getURLSearchParams().get(t)}static stringify(t){const e=new URLSearchParams(t);return e.sort(),e.toString()}}},757:(t,e,n)=>{"use strict";n.d(e,{r:()=>r});var i=n(582),o=n(950);let r=class{static extract(t){const e=t.split(".");if(e.length<2)return t;let n=`.${e[e.length-2]}.${e[e.length-1]}`;return[".co.jp",".co.nz",".co.uk"].indexOf(n)>=0&&(n=`.${e[e.length-3]}${n}`),n}};r=(0,i.gn)([(0,o.b2)()],r)},518:(t,e,n)=>{"use strict";function i(t,e=10,n=50){return new Promise(((i,o)=>{let r=0;const s=setInterval((()=>{t()&&(clearInterval(s),i()),r++>e&&(clearInterval(s),o())}),n)}))}n.d(e,{X:()=>i})},950:(t,e,n)=>{"use strict";var i;n.d(e,{nC:()=>M,gw:()=>h,f3:()=>T,XH:()=>P,b2:()=>E,ri:()=>x}),function(t){t[t.Transient=0]="Transient",t[t.Singleton=1]="Singleton",t[t.ResolutionScoped=2]="ResolutionScoped",t[t.ContainerScoped=3]="ContainerScoped"}(i||(i={}));const o=i;var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},r(t,e)};function s(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function a(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function u(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t}function d(t){return!!t.useClass}function l(t){return!!t.useFactory}var f=function(){function t(t){this.wrap=t,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return t.prototype.createProxy=function(t){var e,n=this,i=!1;return new Proxy({},this.createHandler((function(){return i||(e=t(n.wrap()),i=!0),e})))},t.prototype.createHandler=function(t){var e={};return this.reflectMethods.forEach((function(n){e[n]=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return e[0]=t(),Reflect[n].apply(void 0,u(e))}})),e},t}();function h(t){if(void 0===t)throw new Error("Attempt to `delay` undefined. Constructor must be wrapped in a callback");return new f(t)}function p(t){return"string"==typeof t||"symbol"==typeof t}function g(t){return"object"==typeof t&&"token"in t&&"transform"in t}function v(t){return!!t.useToken}function y(t){return null!=t.useValue}const m=function(){function t(){this._registryMap=new Map}return t.prototype.entries=function(){return this._registryMap.entries()},t.prototype.getAll=function(t){return this.ensure(t),this._registryMap.get(t)},t.prototype.get=function(t){this.ensure(t);var e=this._registryMap.get(t);return e[e.length-1]||null},t.prototype.set=function(t,e){this.ensure(t),this._registryMap.get(t).push(e)},t.prototype.setAll=function(t,e){this._registryMap.set(t,e)},t.prototype.has=function(t){return this.ensure(t),this._registryMap.get(t).length>0},t.prototype.clear=function(){this._registryMap.clear()},t.prototype.ensure=function(t){this._registryMap.has(t)||this._registryMap.set(t,[])},t}(),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(m),b=function(){this.scopedResolutions=new Map};var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(m),k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(m);const S=function(){this.preResolution=new C,this.postResolution=new k};var O=new Map,_=function(){function t(t){this.parent=t,this._registry=new w,this.interceptors=new S,this.disposed=!1,this.disposables=new Set}return t.prototype.register=function(t,e,n){var i;if(void 0===n&&(n={lifecycle:o.Transient}),this.ensureNotDisposed(),i=function(t){return d(t)||y(t)||v(t)||l(t)}(e)?e:{useClass:e},v(i))for(var r=[t],s=i;null!=s;){var a=s.useToken;if(r.includes(a))throw new Error("Token registration cycle detected! "+u(r,[a]).join(" -> "));r.push(a);var c=this._registry.get(a);s=c&&v(c.provider)?c.provider:null}if((n.lifecycle===o.Singleton||n.lifecycle==o.ContainerScoped||n.lifecycle==o.ResolutionScoped)&&(y(i)||l(i)))throw new Error('Cannot use lifecycle "'+o[n.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(t,{provider:i,options:n}),this},t.prototype.registerType=function(t,e){return this.ensureNotDisposed(),p(e)?this.register(t,{useToken:e}):this.register(t,{useClass:e})},t.prototype.registerInstance=function(t,e){return this.ensureNotDisposed(),this.register(t,{useValue:e})},t.prototype.registerSingleton=function(t,e){if(this.ensureNotDisposed(),p(t)){if(p(e))return this.register(t,{useToken:e},{lifecycle:o.Singleton});if(e)return this.register(t,{useClass:e},{lifecycle:o.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var n=t;return e&&!p(e)&&(n=e),this.register(t,{useClass:n},{lifecycle:o.Singleton})},t.prototype.resolve=function(t,e){void 0===e&&(e=new b),this.ensureNotDisposed();var n=this.getRegistration(t);if(!n&&p(t))throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"');if(this.executePreResolutionInterceptor(t,"Single"),n){var i=this.resolveRegistration(n,e);return this.executePostResolutionInterceptor(t,i,"Single"),i}if(function(t){return"function"==typeof t||t instanceof f}(t))return i=this.construct(t,e),this.executePostResolutionInterceptor(t,i,"Single"),i;throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},t.prototype.executePreResolutionInterceptor=function(t,e){var n,i;if(this.interceptors.preResolution.has(t)){var o=[];try{for(var r=a(this.interceptors.preResolution.getAll(t)),s=r.next();!s.done;s=r.next()){var c=s.value;"Once"!=c.options.frequency&&o.push(c),c.callback(t,e)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}this.interceptors.preResolution.setAll(t,o)}},t.prototype.executePostResolutionInterceptor=function(t,e,n){var i,o;if(this.interceptors.postResolution.has(t)){var r=[];try{for(var s=a(this.interceptors.postResolution.getAll(t)),c=s.next();!c.done;c=s.next()){var u=c.value;"Once"!=u.options.frequency&&r.push(u),u.callback(t,e,n)}}catch(t){i={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}this.interceptors.postResolution.setAll(t,r)}},t.prototype.resolveRegistration=function(t,e){if(this.ensureNotDisposed(),t.options.lifecycle===o.ResolutionScoped&&e.scopedResolutions.has(t))return e.scopedResolutions.get(t);var n,i=t.options.lifecycle===o.Singleton,r=t.options.lifecycle===o.ContainerScoped,s=i||r;return n=y(t.provider)?t.provider.useValue:v(t.provider)?s?t.instance||(t.instance=this.resolve(t.provider.useToken,e)):this.resolve(t.provider.useToken,e):d(t.provider)?s?t.instance||(t.instance=this.construct(t.provider.useClass,e)):this.construct(t.provider.useClass,e):l(t.provider)?t.provider.useFactory(this):this.construct(t.provider,e),t.options.lifecycle===o.ResolutionScoped&&e.scopedResolutions.set(t,n),n},t.prototype.resolveAll=function(t,e){var n=this;void 0===e&&(e=new b),this.ensureNotDisposed();var i=this.getAllRegistrations(t);if(!i&&p(t))throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"');if(this.executePreResolutionInterceptor(t,"All"),i){var o=i.map((function(t){return n.resolveRegistration(t,e)}));return this.executePostResolutionInterceptor(t,o,"All"),o}var r=[this.construct(t,e)];return this.executePostResolutionInterceptor(t,r,"All"),r},t.prototype.isRegistered=function(t,e){return void 0===e&&(e=!1),this.ensureNotDisposed(),this._registry.has(t)||e&&(this.parent||!1)&&this.parent.isRegistered(t,!0)},t.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},t.prototype.clearInstances=function(){var t,e;this.ensureNotDisposed();try{for(var n=a(this._registry.entries()),i=n.next();!i.done;i=n.next()){var o=c(i.value,2),r=o[0],s=o[1];this._registry.setAll(r,s.filter((function(t){return!y(t.provider)})).map((function(t){return t.instance=void 0,t})))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.createChildContainer=function(){var e,n;this.ensureNotDisposed();var i=new t(this);try{for(var r=a(this._registry.entries()),s=r.next();!s.done;s=r.next()){var u=c(s.value,2),d=u[0],l=u[1];l.some((function(t){return t.options.lifecycle===o.ContainerScoped}))&&i._registry.setAll(d,l.map((function(t){return t.options.lifecycle===o.ContainerScoped?{provider:t.provider,options:t.options}:t})))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i},t.prototype.beforeResolution=function(t,e,n){void 0===n&&(n={frequency:"Always"}),this.interceptors.preResolution.set(t,{callback:e,options:n})},t.prototype.afterResolution=function(t,e,n){void 0===n&&(n={frequency:"Always"}),this.interceptors.postResolution.set(t,{callback:e,options:n})},t.prototype.dispose=function(){return t=this,e=void 0,i=function(){var t;return function(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,(function(e){switch(e.label){case 0:return this.disposed=!0,t=[],this.disposables.forEach((function(e){var n=e.dispose();n&&t.push(n)})),[4,Promise.all(t)];case 1:return e.sent(),[2]}}))},new((n=void 0)||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}));var t,e,n,i},t.prototype.getRegistration=function(t){return this.isRegistered(t)?this._registry.get(t):this.parent?this.parent.getRegistration(t):null},t.prototype.getAllRegistrations=function(t){return this.isRegistered(t)?this._registry.getAll(t):this.parent?this.parent.getAllRegistrations(t):null},t.prototype.construct=function(t,e){var n=this;if(t instanceof f)return t.createProxy((function(t){return n.resolve(t,e)}));var i,o=function(){var i=O.get(t);if(!i||0===i.length){if(0===t.length)return new t;throw new Error('TypeInfo not known for "'+t.name+'"')}var o=i.map(n.resolveParams(e,t));return new(t.bind.apply(t,u([void 0],o)))}();return"function"!=typeof(i=o).dispose||i.dispose.length>0||this.disposables.add(o),o},t.prototype.resolveParams=function(t,e){var n=this;return function(i,o){var r,s,a,d;try{return"object"==typeof(d=i)&&"token"in d&&"multiple"in d?g(i)?i.multiple?(r=n.resolve(i.transform)).transform.apply(r,u([n.resolveAll(i.token)],i.transformArgs)):(s=n.resolve(i.transform)).transform.apply(s,u([n.resolve(i.token,t)],i.transformArgs)):i.multiple?n.resolveAll(i.token):n.resolve(i.token,t):g(i)?(a=n.resolve(i.transform,t)).transform.apply(a,u([n.resolve(i.token,t)],i.transformArgs)):n.resolve(i,t)}catch(t){throw new Error(function(t,e,n){var i,o,r,s,a=c(t.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1];return i="Cannot inject the dependency "+(s=e,(null===(r=void 0===a?null:a)?"at position #"+s:'"'+r.split(",")[s].trim()+'" at position #'+s)+' of "')+t.name+'" constructor. Reason:',void 0===o&&(o="    "),u([i],n.message.split("\n").map((function(t){return o+t}))).join("\n")}(e,o,t))}}},t.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},t}(),M=new _,j="injectionTokens";function I(t,e){return function(n,i,o){var r=Reflect.getOwnMetadata(j,n)||{};r[o]=e?{token:t,transform:e.transformToken,transformArgs:e.args||[]}:t,Reflect.defineMetadata(j,r,n)}}const T=function(t){return I(t)},E=function(){return function(t){O.set(t,function(t){var e=Reflect.getMetadata("design:paramtypes",t)||[],n=Reflect.getOwnMetadata(j,t)||{};return Object.keys(n).forEach((function(t){e[+t]=n[t]})),e}(t))}},x=function(){return function(t){E()(t),M.registerSingleton(t)}},P=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return I(t,{transformToken:e,args:n})};if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.")},582:(t,e,n)=>{"use strict";function i(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}function o(t,e){return function(n,i){e(n,i,t)}}function r(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function s(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))}n.d(e,{fM:()=>o,gn:()=>i,mG:()=>s,w6:()=>r}),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError}},i={};function o(t){var e=i[t];if(void 0!==e)return e.exports;var r=i[t]={exports:{}};return n[t](r,r.exports,o),r.exports}o.m=n,o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.f={},o.e=t=>Promise.all(Object.keys(o.f).reduce(((e,n)=>(o.f[n](t,e),e)),[])),o.u=t=>({165:"one-trust-consents",221:"fandom-gdpr-consents",985:"fanatical-consents"}[t]+".js"),o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="identity-engine:",o.l=(n,i,r,s)=>{if(t[n])t[n].push(i);else{var a,c;if(void 0!==r)for(var u=document.getElementsByTagName("script"),d=0;d<u.length;d++){var l=u[d];if(l.getAttribute("src")==n||l.getAttribute("data-webpack")==e+r){a=l;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",e+r),a.src=n),t[n]=[i];var f=(e,i)=>{a.onerror=a.onload=null,clearTimeout(h);var o=t[n];if(delete t[n],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((t=>t(i))),e)return e(i)},h=setTimeout(f.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=f.bind(null,a.onerror),a.onload=f.bind(null,a.onload),c&&document.head.appendChild(a)}},o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;o.g.importScripts&&(t=o.g.location+"");var e=o.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&!t;)t=n[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=t})(),(()=>{var t={826:0};o.f.j=(e,n)=>{var i=o.o(t,e)?t[e]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise(((n,o)=>i=t[e]=[n,o]));n.push(i[2]=r);var s=o.p+o.u(e),a=new Error;o.l(s,(n=>{if(o.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,i[1](a)}}),"chunk-"+e,e)}};var e=(e,n)=>{var i,r,[s,a,c]=n,u=0;if(s.some((e=>0!==t[e]))){for(i in a)o.o(a,i)&&(o.m[i]=a[i]);c&&c(o)}for(e&&e(n);u<s.length;u++)r=s[u],o.o(t,r)&&t[r]&&t[r][0](),t[r]=0},n=self.webpackChunkidentity_engine=self.webpackChunkidentity_engine||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),(()=>{"use strict";var t=o(582),e=(o(660),o(950));function n(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}var i=function t(e,i){function o(t,o,r){if("undefined"!=typeof document){"number"==typeof(r=n({},i,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var a in r)r[a]&&(s+="; "+a,!0!==r[a]&&(s+="="+r[a].split(";")[0]));return document.cookie=t+"="+e.write(o,t)+s}}return Object.create({set:o,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var n=document.cookie?document.cookie.split("; "):[],i={},o=0;o<n.length;o++){var r=n[o].split("="),s=r.slice(1).join("=");try{var a=decodeURIComponent(r[0]);if(i[a]=e.read(s,a),t===a)break}catch(t){}}return t?i[t]:i}},remove:function(t,e){o(t,"",n({},e,{expires:-1}))},withAttributes:function(e){return t(this.converter,n({},this.attributes,e))},withConverter:function(e){return t(n({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(e)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});const r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let s;const a=new Uint8Array(16);function c(){if(!s&&(s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!s))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(a)}const u=[];for(let t=0;t<256;++t)u.push((t+256).toString(16).slice(1));var d=o(41);let l=class{get(e){return(0,t.mG)(this,void 0,void 0,(function*(){const t=yield fetch(e,{method:"GET",mode:"cors"});if(!t.ok||200!==t.status)throw new Error(`HTTP error ${e}! Status: ${t.status}`);return t}))}};l=(0,t.gn)([(0,e.b2)()],l);var f=o(466),h=o(115);let p=class{get(){return["fandom.com","tvguide.com","metacritic.com","gamespot.com","giantbomb.com","muthead.com","futhead.com","fandom-ae-assets.s3.amazonaws.com","fanatical.com"].find((t=>window.location.hostname.includes(t)))?"https://services.fandom.com/":"https://services.fandom-dev."+(location.hostname.match(/(?!\.)(pl|us)$/)||["us"])[0]+"/"}};var g,v,y,m,w;p=(0,t.gn)([(0,e.ri)()],p);let b=class{constructor(t,e,n,i,o){this.cookiesManager=t,this.httpClient=e,this.logger=n,this.geo=i,this.serviceBaseUrl=o,this.geoIPUrl=this.serviceBaseUrl.get()+"geoip/location"}setGeoCookieIfNotExist(){return(0,t.mG)(this,void 0,void 0,(function*(){if(this.cookiesManager.get("Geo"))return void this.logger.info("Geo cookie already exists");const t=yield this.httpClient.get(this.geoIPUrl),{country_code:e,region:n,continent_code:i}=yield t.json(),o={country:e,region:n,continent:i},r=JSON.stringify(o);this.cookiesManager.set("Geo",r,{expires:365}),this.geo.set(o),this.logger.info("Geo cookie set")}))}};b=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(f.E9)),(0,t.fM)(1,(0,e.f3)(l)),(0,t.fM)(2,(0,e.XH)(d.Y,d.d,"GeoCookie")),(0,t.fM)(3,(0,e.f3)(h.l)),(0,t.fM)(4,(0,e.f3)(p)),(0,t.w6)("design:paramtypes",["function"==typeof(g="undefined"!=typeof CookiesManager&&CookiesManager)?g:Object,"function"==typeof(v=void 0!==l&&l)?v:Object,"function"==typeof(y=void 0!==d.Y&&d.Y)?y:Object,"function"==typeof(m=void 0!==h.l&&h.l)?m:Object,"function"==typeof(w=void 0!==p&&p)?w:Object])],b);class C{constructor(t,e){this.__global=!0,this.timestamp=Date.now(),this.name=t.name,this.category=t.category||"[Identity]",this.type=`${this.category} ${t.name}`,Object.assign(this,e)}}const k={category:"[AdEngine OptIn]",name:"set opt in"},S={category:"[IdentityEngine]",name:"Identity ready"},O={category:"[AdEngine]",name:"Identity partner data obtained"},_={name:"Age gate result",category:"[Identity]"},M={name:"Page changed",category:"[Platform]"},j={category:"[AdEngine]",name:"Instant Config cache ready"};var I,T=o(757);let E=class{constructor(t){this.window=t}get(t,e=null){var n,i,o;return null!==(o=null===(i=null===(n=this.window.mw)||void 0===n?void 0:n.config)||void 0===i?void 0:i.get(t))&&void 0!==o?o:e}};var x;E=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(f.m9)),(0,t.w6)("design:paramtypes",["function"==typeof(I="undefined"!=typeof Window&&Window)?I:Object])],E);let P=class{constructor(t){this.window=t}get(){var t;return null===(t=this.window.ads)||void 0===t?void 0:t.context}};var R,D,L,A,N;P=(0,t.gn)([(0,e.b2)(),(0,t.fM)(0,(0,e.f3)(f.m9)),(0,t.w6)("design:paramtypes",["function"==typeof(x="undefined"!=typeof Window&&Window)?x:Object])],P);let G=class{constructor(t,e,n,i,o){this.cookiesManager=t,this.window=e,this.wikiConfig=n,this.context=i,this.logger=o,this.ageGateCookie="ag",this.ageGateLegacyCookie="age_gate",this.ageGateExpiryMs=31536e6}init(e){var n,i;return(0,t.mG)(this,void 0,void 0,(function*(){if(!Boolean(null===(i=null===(n=this.context.get())||void 0===n?void 0:n.targeting)||void 0===i?void 0:i.directedAtChildren)||!this.wikiConfig.get("wgAgeGateEnabled",!1))return this.logger.info("disabled"),Promise.resolve();const t=this.cookiesManager.get(this.ageGateLegacyCookie);return t?(this.updateLegacyCookie(t),Promise.resolve()):(this.cookiesManager.get(this.ageGateCookie)||(yield this.waitForAgeGateDataAndSetCookie(e)),Promise.resolve())}))}waitForAgeGateDataAndSetCookie(e){return(0,t.mG)(this,void 0,void 0,(function*(){return new Promise((t=>{e.on(_,(({payload:e})=>{this.setCookie(e),t()}))}))}))}setCookie(t){var e,n;t||this.logger.warn("Payload data missing, using defaults");const i=null!==(e=null==t?void 0:t.adult)&&void 0!==e&&e,o=null!==(n=null==t?void 0:t.timestamp)&&void 0!==n?n:Date.now();this.cookiesManager.set(this.ageGateCookie,i?"1":"0",{domain:this.getTopLevelDomain(),expires:new Date(o+this.ageGateExpiryMs)})}updateLegacyCookie(t){if(t.length>=3){const e=t.split("|");this.setCookie({adult:"1"===e[1],timestamp:Date.now()})}this.cookiesManager.remove(this.ageGateLegacyCookie,{domain:this.getTopLevelDomain()})}getTopLevelDomain(){const t=this.window.location.hostname;return T.r.extract(t)}};G=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(f.E9)),(0,t.fM)(1,(0,e.f3)(f.m9)),(0,t.fM)(2,(0,e.f3)(E)),(0,t.fM)(3,(0,e.f3)(P)),(0,t.fM)(4,(0,e.XH)(d.Y,d.d,"AgeGate")),(0,t.w6)("design:paramtypes",["function"==typeof(R="undefined"!=typeof CookiesManager&&CookiesManager)?R:Object,"function"==typeof(D="undefined"!=typeof Window&&Window)?D:Object,"function"==typeof(L=void 0!==E&&E)?L:Object,"function"==typeof(A=void 0!==P&&P)?A:Object,"function"==typeof(N=void 0!==d.Y&&d.Y)?N:Object])],G);var U=function(){return U=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},U.apply(this,arguments)},W={channelId:"default",host:window,coordinatorHost:window.top},Y={connect:"connect",connected:"connected"},H="@wikia/post-quecast";function $(t){return t.channelId&&t.libId===H&&t.action&&function(t){return"string"==typeof t.type&&"number"==typeof t.timestamp}(t.action)}function F(t){return!t.data.private}function V(t,e){return t.data.channelId===e}function B(t){return t.data.action}var z,q=function(){function t(){}return t.make=function(t){return function(t){var e;return t.host===t.coordinatorHost&&!!(null===(e=t.coordinatorHost[H])||void 0===e?void 0:e.callbackConnector)}(t)?t.coordinatorHost[H].callbackConnector:new K({senderHost:t.coordinatorHost,listenerHost:t.host})},t}(),X=function(){function t(t){this.coordinatorHost=t,this.callbacks=[]}return t.prototype.dispatch=function(t){var e=this;if(!$(t))throw new Error("Incorrect object type. Expected PostMessageData, but got "+t);this.callbacks.forEach((function(n){return n({data:t,source:e.coordinatorHost})}))},t.prototype.addListener=function(t){this.callbacks.push(t)},t.prototype.removeListener=function(t){this.callbacks=this.callbacks.filter((function(e){return e!==t}))},t}(),K=function(){function t(t){this.options=t,this.map=new Map}return t.prototype.dispatch=function(t){if(!$(t))throw new Error("Incorrect object type. Expected PostMessageData, but got "+t);this.options.senderHost.postMessage(t,"*")},t.prototype.addListener=function(t){var e=function(e){var n;(n=e)&&n.source&&n.data&&$(n.data)&&t(e)};this.map.set(t,e),this.options.listenerHost.addEventListener("message",e)},t.prototype.removeListener=function(t){var e=this.map.get(t);this.options.listenerHost.removeEventListener("message",e),this.map.delete(t)},t}(),J=function(){function t(t){this.callbacks=[],this.history=[],this.channelId=t.channelId,this.connector=q.make(t),this.setupActions(),this.setupConnection()}return t.prototype.setupActions=function(){this.getHistory(),this.listenEvent()},t.prototype.getHistory=function(){var t=this,e=function(n){if(V(n,t.channelId)&&function(t){return!!t.data.private}(n)){var i=B(n);(function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.some((function(e){return t.type===e}))})(i,Y.connected)&&(t.connector.removeListener(e),t.handleActions.apply(t,i.history))}};this.connector.addListener(e)},t.prototype.listenEvent=function(){var t=this;this.connector.addListener((function(e){if(V(e,t.channelId)&&F(e)){var n=B(e);t.handleActions(n)}}))},t.prototype.handleActions=function(){for(var t,e=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];(t=this.history).push.apply(t,n),n.forEach((function(t){return e.callbacks.forEach((function(e){return e(t)}))}))},t.prototype.setupConnection=function(){this.connector.dispatch({action:{type:Y.connect,timestamp:Date.now()},channelId:this.channelId,private:!0,libId:H})},t.prototype.addListener=function(t){this.history.forEach((function(e){return t(e)})),this.callbacks.push(t)},t.prototype.removeListener=function(t){this.callbacks=this.callbacks.filter((function(e){return e!==t}))},t}(),Q=function(){function t(t){void 0===t&&(t={});var e=U(U({},W),t);this.channelId=e.channelId,this.connector=q.make(e)}return t.prototype.dispatch=function(t){this.connector.dispatch({action:U(U({},t),{timestamp:Date.now()}),channelId:this.channelId,private:!0,libId:H})},t}(),Z=function(){function t(t){void 0===t&&(t={});var e=U(U({},W),t);this.transmitter=new Q(e),this.receiver=new J(e)}return t.prototype.dispatch=function(t){this.transmitter.dispatch(t)},t.prototype.addListener=function(t){this.receiver.addListener(t)},t.prototype.removeListener=function(t){this.receiver.removeListener(t)},t}(),tt=function(){function t(t,e){this.channelId=t,this.connectors=new Map,this.history=[],this.connectors.set(e,e[H].callbackConnector)}return t.prototype.addConnection=function(t){this.ensureConnector(t).dispatch({action:this.createConnectedAction(),private:!0,channelId:this.channelId,libId:H})},t.prototype.createConnectedAction=function(){return{type:Y.connected,history:this.history,timestamp:Date.now()}},t.prototype.broadcast=function(t){var e=this;this.history.push(t),this.connectors.forEach((function(n){n.dispatch({action:t,channelId:e.channelId,libId:H})}))},t.prototype.ensureConnector=function(t){return this.connectors.has(t)||this.connectors.set(t,new K({senderHost:t,listenerHost:t})),this.connectors.get(t)},t}(),et=function(){function t(t){this.coordinatorHost=t,this.channels=new Map,this.callbackConnector=new X(t),this.postMessageConnector=new K({senderHost:t,listenerHost:t})}return t.prototype.init=function(){var t=this,e=function(e){F(e)||(t.handleConnect(e),t.handleBroadcast(e))};this.callbackConnector.addListener(e),this.postMessageConnector.addListener(e)},t.prototype.handleConnect=function(t){(function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.some((function(e){return t.data.action.type===e}))})(t,Y.connect)&&this.ensureChannel(t.data.channelId).addConnection(t.source)},t.prototype.handleBroadcast=function(t){(function(t){return!Object.values(Y).some((function(e){return t.data.action.type===e}))})(t)&&this.ensureChannel(t.data.channelId).broadcast(t.data.action)},t.prototype.ensureChannel=function(t){return this.channels.has(t)||this.channels.set(t,new tt(t,this.coordinatorHost)),this.channels.get(t)},t}();function nt(t){if(void 0===t&&(t=window),!t[H]){var e=new et(t);e.init(),t[H]=e}}let it=class{constructor(t){this.window=t,this.history=new Map;const{channelId:e,coordinatorName:n}=this.getSettings();nt(),this.communicator=new Z({channelId:e||"default",coordinatorHost:t[n]||top})}emit(t){this.communicator.dispatch(t)}on(t,e){this.communicator.addListener((n=>this.run(n,t,e)))}once(t,e){this.communicator.addListener((n=>this.runOnce(n,t,e)))}getSettings(){return this.window["@wikia/post-quecast-settings"]||{}}run(t,e,n){this.ofType(t,e)&&n(t)}runOnce(t,e,n){const i=e.category+" "+e.name;this.ofType(t,e)&&(this.history.has(i)||(this.history.set(i,!0),n(t)))}ofType(t,e){return t.category===e.category&&t.name===e.name||t.type===e.category+" "+e.name}};it=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(f.m9)),(0,t.w6)("design:paramtypes",["function"==typeof(z="undefined"!=typeof Window&&Window)?z:Object])],it);var ot=o(492),rt=o(639),st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at=window.device,ct={},ut=[];window.device=ct;var dt=window.document.documentElement,lt=window.navigator.userAgent.toLowerCase(),ft=["googletv","viera","smarttv","internet.tv","netcast","nettv","appletv","boxee","kylo","roku","dlnadoc","pov_tv","hbbtv","ce-html"];function ht(t,e){return-1!==t.indexOf(e)}function pt(t){return ht(lt,t)}function gt(t){return dt.className.match(new RegExp(t,"i"))}function vt(t){var e=null;gt(t)||(e=dt.className.replace(/^\s+|\s+$/g,""),dt.className=e+" "+t)}function yt(t){gt(t)&&(dt.className=dt.className.replace(" "+t,""))}function mt(){ct.landscape()?(yt("portrait"),vt("landscape"),wt("landscape")):(yt("landscape"),vt("portrait"),wt("portrait")),kt()}function wt(t){for(var e=0;e<ut.length;e++)ut[e](t)}ct.macos=function(){return pt("mac")},ct.ios=function(){return ct.iphone()||ct.ipod()||ct.ipad()},ct.iphone=function(){return!ct.windows()&&pt("iphone")},ct.ipod=function(){return pt("ipod")},ct.ipad=function(){var t="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;return pt("ipad")||t},ct.android=function(){return!ct.windows()&&pt("android")},ct.androidPhone=function(){return ct.android()&&pt("mobile")},ct.androidTablet=function(){return ct.android()&&!pt("mobile")},ct.blackberry=function(){return pt("blackberry")||pt("bb10")},ct.blackberryPhone=function(){return ct.blackberry()&&!pt("tablet")},ct.blackberryTablet=function(){return ct.blackberry()&&pt("tablet")},ct.windows=function(){return pt("windows")},ct.windowsPhone=function(){return ct.windows()&&pt("phone")},ct.windowsTablet=function(){return ct.windows()&&pt("touch")&&!ct.windowsPhone()},ct.fxos=function(){return(pt("(mobile")||pt("(tablet"))&&pt(" rv:")},ct.fxosPhone=function(){return ct.fxos()&&pt("mobile")},ct.fxosTablet=function(){return ct.fxos()&&pt("tablet")},ct.meego=function(){return pt("meego")},ct.cordova=function(){return window.cordova&&"file:"===location.protocol},ct.nodeWebkit=function(){return"object"===st(window.process)},ct.mobile=function(){return ct.androidPhone()||ct.iphone()||ct.ipod()||ct.windowsPhone()||ct.blackberryPhone()||ct.fxosPhone()||ct.meego()},ct.tablet=function(){return ct.ipad()||ct.androidTablet()||ct.blackberryTablet()||ct.windowsTablet()||ct.fxosTablet()},ct.desktop=function(){return!ct.tablet()&&!ct.mobile()},ct.television=function(){for(var t=0;t<ft.length;){if(pt(ft[t]))return!0;t++}return!1},ct.portrait=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?ht(screen.orientation.type,"portrait"):ct.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90!==Math.abs(window.orientation):window.innerHeight/window.innerWidth>1},ct.landscape=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?ht(screen.orientation.type,"landscape"):ct.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90===Math.abs(window.orientation):window.innerHeight/window.innerWidth<1},ct.noConflict=function(){return window.device=at,this},ct.ios()?ct.ipad()?vt("ios ipad tablet"):ct.iphone()?vt("ios iphone mobile"):ct.ipod()&&vt("ios ipod mobile"):ct.macos()?vt("macos desktop"):ct.android()?ct.androidTablet()?vt("android tablet"):vt("android mobile"):ct.blackberry()?ct.blackberryTablet()?vt("blackberry tablet"):vt("blackberry mobile"):ct.windows()?ct.windowsTablet()?vt("windows tablet"):ct.windowsPhone()?vt("windows mobile"):vt("windows desktop"):ct.fxos()?ct.fxosTablet()?vt("fxos tablet"):vt("fxos mobile"):ct.meego()?vt("meego mobile"):ct.nodeWebkit()?vt("node-webkit"):ct.television()?vt("television"):ct.desktop()&&vt("desktop"),ct.cordova()&&vt("cordova"),ct.onChangeOrientation=function(t){"function"==typeof t&&ut.push(t)};var bt="resize";function Ct(t){for(var e=0;e<t.length;e++)if(ct[t[e]]())return t[e];return"unknown"}function kt(){ct.orientation=Ct(["portrait","landscape"])}Object.prototype.hasOwnProperty.call(window,"onorientationchange")&&(bt="orientationchange"),window.addEventListener?window.addEventListener(bt,mt,!1):window.attachEvent?window.attachEvent(bt,mt):window[bt]=mt,mt(),ct.type=Ct(["mobile","tablet","desktop"]),ct.os=Ct(["ios","iphone","ipad","ipod","android","blackberry","macos","windows","fxos","meego","television"]),kt();const St=ct;let Ot=class{getDeviceType(){return St.tablet()?"tablet":St.mobile()?"smartphone":"desktop"}};Ot=(0,t.gn)([(0,e.ri)()],Ot);let _t=class{getBrowser(){let t;const{appName:e,appVersion:n,userAgent:i}=window.navigator;let o,r=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(r[1])?(o=/\brv[ :]+(\d+)/g.exec(i)||[""],t=`IE ${o[1]||""}`,t):"Chrome"===r[1]&&(o=i.match(/\b(OPR|Edg)\/(\d+)/),null!==o)?(t=o.slice(1).join(" ").replace("OPR","Opera").replace("Edg","Edge"),t):(r=r[2]?[r[1],r[2]]:[e,n,"-?"],o=i.match(/version\/(\d+)/i),null!==o&&r.splice(1,1,o[1]),t=r.join(" "),t)}};_t=(0,t.gn)([(0,e.ri)()],_t);let Mt=class{get(){var t,e,n;return rt.L.get("identity_icbm_app")||(void 0!==window.mw&&void 0!==(null===(n=null===(e=null===(t=window.ads)||void 0===t?void 0:t.context)||void 0===e?void 0:e.opts)||void 0===n?void 0:n.platformName)?window.ads.context.opts.platformName:this.checkHostname())}checkHostname(){const{hostname:t,pathname:e}=window.location;switch(!0){case t.includes("fandom"):return t.includes("bingebot")?"bingebot":"f2";case t.includes("futhead"):return"futhead";case t.includes("muthead"):return"muthead";case t.includes("gamespot"):return t.includes("comicvine")?"comicvine":t.includes("gamefaqs")?"gamefaqs":"gamespot";case t.includes("metacritic"):return e.includes("news")?"metacritic-neutron":"metacritic";case t.includes("tvguide"):return"tvguide";case t.includes("giantbomb"):return"giantbomb";case t.includes("fanatical"):return"fanatical";default:return"fandomdesktop"}}};Mt=(0,t.gn)([(0,e.ri)()],Mt);class jt{constructor(t,n,i){this.window=t,this.cookiesManager=n,this.communicationService=i,this.cacheStorage={},this.cacheKey="basset";const o=e.nC.resolve(d.Y);o.setLoggerGroup("InstantConfig"),this.logger=o,this.resetCache()}resetCache(){const t=this.cookiesManager.get(this.cacheKey)||"";var e;this.cacheStorage=""===(e=t)||"string"!=typeof e?{}:e.split("|").reduce(((t,e)=>Object.assign(Object.assign({},t),function(t){const[e,n]=t.split(":"),i="true"===n,[o,r,s]=e.split("_");return{[o]:{name:o,group:r,limit:parseFloat(s)||void 0,result:i}}}(e))),{}),this.logger.info("reset cache",this.cacheStorage)}get(t){return this.cacheStorage[t]}set(t){this.cacheStorage[t.name]=t}synchronizeCookie(){this.communicationService.on(k,(({gdprConsent:t})=>{t&&(this.saveCookie(),this.communicationService.emit(new C(j)))}))}saveCookie(){const t=Object.keys(this.cacheStorage).map((t=>({key:t,value:this.cacheStorage[t]}))).filter((({value:t})=>t.withCookie)).reduce(((t,{key:e,value:n})=>Object.assign(Object.assign({},t),{[e]:n})),{}),e=this.window.location.hostname,n=T.r.extract(e),i=(o=t,Object.keys(o).slice(0,5).map(function(t){return e=>{const{name:n,group:i,limit:o,result:r}=t[e];return`${n}_${i}_${o}:${r}`}}(o)).join("|"));var o;this.cookiesManager.set(this.cacheKey,i,{domain:n}),this.logger.info("saved in cookie",this.cacheStorage,i)}}var It,Tt,Et,xt,Pt,Rt,Dt;let Lt=class{constructor(t,e,n,i,o,r,s){this.device=t,this.browser=e,this.platform=n,this.geo=i,this.window=o,this.cookiesManager=r,this.logger=s}init(e,n={}){return(0,t.mG)(this,void 0,void 0,(function*(){const t=this.platform.get(),i=this.geo.get(),o=new ot.InstantConfigLoader({appName:t}),r=new jt(this.window,this.cookiesManager,e),s=new ot.InstantConfigInterpreter(new ot.BrowserMatcher(this.browser.getBrowser()),new ot.DeviceMatcher(this.device.getDeviceType()),new ot.DomainMatcher,new ot.RegionMatcher(i),r);let a=yield o.getConfig();a=(new ot.InstantConfigOverrider).override(rt.L.getURLSearchParams(),a);const c=s.init(a,n);return this.repository=c.getValues(),r.synchronizeCookie(),this.logger.info("instantiated with",this.repository),this}))}get(t,e){return t in this.repository&&void 0!==this.repository[t]?this.repository[t]:e}};Lt=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(Ot)),(0,t.fM)(1,(0,e.f3)(_t)),(0,t.fM)(2,(0,e.f3)(Mt)),(0,t.fM)(3,(0,e.f3)(h.l)),(0,t.fM)(4,(0,e.f3)(f.m9)),(0,t.fM)(5,(0,e.f3)(f.E9)),(0,t.fM)(6,(0,e.XH)(d.Y,d.d,"InstantConfig")),(0,t.w6)("design:paramtypes",["function"==typeof(It=void 0!==Ot&&Ot)?It:Object,"function"==typeof(Tt=void 0!==_t&&_t)?Tt:Object,"function"==typeof(Et=void 0!==Mt&&Mt)?Et:Object,"function"==typeof(xt=void 0!==h.l&&h.l)?xt:Object,"function"==typeof(Pt="undefined"!=typeof Window&&Window)?Pt:Object,"function"==typeof(Rt="undefined"!=typeof CookiesManager&&CookiesManager)?Rt:Object,"function"==typeof(Dt=void 0!==d.Y&&d.Y)?Dt:Object])],Lt);var At,Nt=o(162);let Gt=class{constructor(t){this.window=t,this.USP_API_VERSION=1,this.CCPA_TRACKING_ALLOWED="1YN",this.queue=[],this.consentGiven=new Promise((t=>this.resolveConsent=t))}installUspApi(){this.window.__uspapi=this.uspApiMessage.bind(this),this.addLocatorFrame(),this.addUspMessageListener()}consentsUpdated(t){this.resolveConsent({gdprConsent:!0,geoRequiresConsent:!1,geoRequiresSignal:!0,ccpaSignal:!t.startsWith(this.CCPA_TRACKING_ALLOWED)})}uspApiMessage(t,e,n){"ping"===t?n({uspapiLoaded:!1},!0):"getQueue"===t?n(this.queue,!0):this.queue.push([t,e,n])}addLocatorFrame(){const t="__uspapi";if(this.window.frames[t])return;if("loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",(()=>this.addLocatorFrame()));const e=document.createElement("iframe");e.name=t,e.style.display="none",document.body.appendChild(e)}addUspMessageListener(){this.window.addEventListener("message",(t=>{const e=this.convertUspMessageData(t);e&&this.uspMessageHandler(e,t)}),!1)}convertUspMessageData(t){try{return("string"==typeof t.data?JSON.parse(t.data):t.data).__uspapiCall}catch(t){}}uspMessageHandler(t,e){this.window.__uspapi(t.command,t.version,((n,i)=>{const o={__uspapiReturn:{returnValue:n,success:i,callId:t.callId}};e.source.postMessage(o,"*")}))}subscribe(){this.window.__uspapi&&this.window.__uspapi("addEventListener",this.USP_API_VERSION,this.consentsUpdated.bind(this))}readTrackingConsents(){this.window.__uspapi&&this.window.__uspapi("getUSPData",this.USP_API_VERSION,this.consentsUpdated.bind(this))}};var Ut,Wt;Gt=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(f.m9)),(0,t.w6)("design:paramtypes",["function"==typeof(At="undefined"!=typeof Window&&Window)?At:Object])],Gt);let Yt=class{constructor(t,e){this.logger=t,this.uspApi=e}get(){return this.logger.info("__uspapi installed"),this.uspApi.consentGiven}};var Ht;Yt=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.XH)(d.Y,d.d,"OptInService")),(0,t.fM)(1,(0,e.f3)(Gt)),(0,t.w6)("design:paramtypes",["function"==typeof(Ut=void 0!==d.Y&&d.Y)?Ut:Object,"function"==typeof(Wt=void 0!==Gt&&Gt)?Wt:Object])],Yt);let $t=class{constructor(t){this.logger=t}addLocatorFrame(){const t="____tcfapiLocator";if(window.frames[t])return;if("loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",(()=>this.addLocatorFrame()));const e=document.body,n=document.createElement("iframe");n.name=t,n.style.display="none",e.appendChild(n)}install(){function t(t){try{let e=t.data;const n="string"==typeof e;if(n)try{e=JSON.parse(e)}catch(t){}const i=e.__tcfapiCall;i&&window.__tcfapi(i.command,i.parameter,(function(e,o){const r={__tcfapiReturn:{returnValue:e,success:o,callId:i.callId}};t.source.postMessage(n?JSON.stringify(r):r,"*")}))}catch(t){}}function e(t,e,n){"addEventListener"===t||"getTCData"===t?n({eventStatus:"tcloaded",cmpLoaded:!0,cmpStatus:"loaded",displayStatus:"disabled",apiVersion:"2",tcfPolicyVersion:2,gdprApplies:!1},!0):n(void 0,!1)}window.__tcfapi?window.__tcfapi("ping",2,(n=>{"stub"===n.cmpStatus&&(window.__tcfapi=e,window.__tcfapi.msgHandler=t,window.addEventListener("message",t,!1),this.logger.info("__tcfapi installed"))})):(window.__tcfapi=e,window.__tcfapi.msgHandler=t,window.addEventListener("message",t,!1),this.logger.info("__tcfapi installed"))}};var Ft,Vt,Bt;$t=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.XH)(d.Y,d.d,"TCF")),(0,t.w6)("design:paramtypes",["function"==typeof(Ht=void 0!==d.Y&&d.Y)?Ht:Object])],$t);let zt=class{constructor(t,e,n){this.geo=t,this.platform=e,this.tcfApi=n}get(t=!1){if(t)return o.e(165).then(o.bind(o,737)).then((({OneTrustConsentStrategy:t})=>e.nC.resolve(t).get()));if("fanatical"===this.platform.get())return o.e(985).then(o.bind(o,23)).then((({FanaticalConsentStrategy:t})=>e.nC.resolve(t).get()));const n=this.geo.getCountryCode();if(n){if("us"===n)return this.tcfApi.install(),e.nC.resolve(Yt).get();if(Nt.a.includes(n))return o.e(221).then(o.bind(o,340)).then((({FandomGdprConsentStrategy:t})=>e.nC.resolve(t).get()))}return this.tcfApi.install(),Promise.resolve({gdprConsent:!0,geoRequiresSignal:!1,geoRequiresConsent:!1,ccpaSignal:!1})}};var qt,Xt,Kt,Jt;zt=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(h.l)),(0,t.fM)(1,(0,e.f3)(Mt)),(0,t.fM)(2,(0,e.f3)($t)),(0,t.w6)("design:paramtypes",["function"==typeof(Ft=void 0!==h.l&&h.l)?Ft:Object,"function"==typeof(Vt=void 0!==Mt&&Mt)?Vt:Object,"function"==typeof(Bt=void 0!==$t&&$t)?Bt:Object])],zt);let Qt=class{get trackingAllowed(){return this._trackingAllowed}set trackingAllowed(t){this._trackingAllowed=t}constructor(t,e,n,i){this.communicationService=t,this.logger=e,this.consentProviderFactory=n,this.instantConfigService=i,this._trackingAllowed=!1}init(){var t;const e=this.instantConfigService.get("icFandom1TEnabled",!1);null===(t=this.consentProviderFactory.get(e))||void 0===t||t.then((t=>{this.logger.info("Sending consents: ",t),this.sendConsentsToAdEngine(t)}))}sendConsentsToAdEngine(t){this.communicationService.emit(new C(k,t))}};var Zt,te,ee;Qt=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(it)),(0,t.fM)(1,(0,e.XH)(d.Y,d.d,"OptInService")),(0,t.fM)(2,(0,e.f3)(zt)),(0,t.fM)(3,(0,e.f3)(Lt)),(0,t.w6)("design:paramtypes",["function"==typeof(qt=void 0!==it&&it)?qt:Object,"function"==typeof(Xt=void 0!==d.Y&&d.Y)?Xt:Object,"function"==typeof(Kt=void 0!==zt&&zt)?Kt:Object,"function"==typeof(Jt=void 0!==Lt&&Lt)?Jt:Object])],Qt),function(t){t[t.identity=0]="identity",t[t.loadTime=1]="loadTime"}(Zt||(Zt={}));let ne=class{constructor(t,e){this.platform=t,this.device=e,this.skinMap={muthead:"turf",futhead:"turf",giantbomb:"giantbomb",gamefaqs:"gamefaqs",gamespot:"gamespot",metacritic:"metacritic","metacritic-neutron":"metacritic_neutron",comicvine:"comicvine",f2:"fandom",tvguide:"tvguide",fandomdesktop:"ucp",fandommobile:"ucp",fanatical:"fanatical"}}get(){const t=this.platform.get(),e="desktop"===this.device.getDeviceType()?"desktop":"mobile";return this.skinMap[t]?this.skinMap[t]+"_"+e:"unknown"}};var ie,oe,re,se,ae,ce,ue;ne=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(Mt)),(0,t.fM)(1,(0,e.f3)(Ot)),(0,t.w6)("design:paramtypes",["function"==typeof(te=void 0!==Mt&&Mt)?te:Object,"function"==typeof(ee=void 0!==Ot&&Ot)?ee:Object])],ne);let de=class{constructor(t,e,n,i,o,r,s){this.logger=t,this.httpClient=e,this.skin=n,this.optInService=i,this.window=o,this.wikiConfig=r,this.geo=s,this.dataWarehouseUrl="https://beacon.wikia-services.com/__track/special/identityinfo",this.initStartTime()}getTimeOrigin(){var t;return null===(t=window.performance)||void 0===t?void 0:t.timeOrigin}initStartTime(){const t=new Date;this.startTime||(this.startTime=this.getTimeOrigin(),this.tzOffset=t.getTimezoneOffset())}getCurrentTimestamp(){return Date.now()}getStartTime(){return this.startTime}getTimezoneOffset(){return this.tzOffset}send(t){this.sendEvent(t,this.dataWarehouseUrl)}sendEvent(t,e){const n=Object.assign(Object.assign(Object.assign({},t),this.getTimeBasedParams()),this.getTrackingParams()),i=this.buildDataWarehouseUrl(n,e);i&&this.httpClient.get(i)}getTrackingParams(){var t,e,n,i,o,r,s,a,c,u,d,l,f;return{browser_ts:this.getCurrentTimestamp(),tz_offset:this.getTimezoneOffset(),country:this.geo.getCountryCode()||"",session_id:null===(e=null===(t=this.window.fandomContext)||void 0===t?void 0:t.tracking)||void 0===e?void 0:e.sessionId,pv_number:null===(i=null===(n=this.window.fandomContext)||void 0===n?void 0:n.tracking)||void 0===i?void 0:i.pvNumber,pv_number_global:null===(r=null===(o=this.window.fandomContext)||void 0===o?void 0:o.tracking)||void 0===r?void 0:r.pvNumberGlobal,pv_unique_id:null===(a=null===(s=this.window.fandomContext)||void 0===s?void 0:s.tracking)||void 0===a?void 0:a.pvUID,beacon:null===(u=null===(c=this.window.fandomContext)||void 0===c?void 0:c.tracking)||void 0===u?void 0:u.beaconId,ua:null===(d=this.window.navigator)||void 0===d?void 0:d.userAgent,c:this.wikiConfig.get("wgCityId")||"unknown",ck:this.wikiConfig.get("dsSiteKey")||"unknown",lc:this.wikiConfig.get("wgUserLanguage")||"unknown",s:this.skin.get(),u:this.optInService.trackingAllowed?this.wikiConfig.get("wgUserId")||0:-1,a:(null===(f=null===(l=this.window.fandomContext)||void 0===l?void 0:l.page)||void 0===f?void 0:f.articleId)||-1,x:this.wikiConfig.get("wgDBname")||"unknown",n:this.wikiConfig.get("wgNamespaceNumber")||-1}}getTimeBasedParams(){return{cb:Math.floor(99999*Math.random()),url:document.URL}}buildDataWarehouseUrl(t,e){if(!e)return void this.logger.error("Error building DWH tracking URL");const n=new URLSearchParams(t);return n.sort(),`${e}?${n.toString()}`}};var le,fe,he,pe,ge,ve;de=(0,t.gn)([(0,e.b2)(),(0,t.fM)(0,(0,e.XH)(d.Y,d.d,"DataWarehouseService")),(0,t.fM)(1,(0,e.f3)(l)),(0,t.fM)(2,(0,e.f3)(ne)),(0,t.fM)(3,(0,e.f3)(Qt)),(0,t.fM)(4,(0,e.f3)(f.m9)),(0,t.fM)(5,(0,e.f3)(E)),(0,t.fM)(6,(0,e.f3)(h.l)),(0,t.w6)("design:paramtypes",["function"==typeof(ie=void 0!==d.Y&&d.Y)?ie:Object,"function"==typeof(oe=void 0!==l&&l)?oe:Object,"function"==typeof(re=void 0!==ne&&ne)?re:Object,"function"==typeof(se=void 0!==Qt&&Qt)?se:Object,"function"==typeof(ae="undefined"!=typeof Window&&Window)?ae:Object,"function"==typeof(ce=void 0!==E&&E)?ce:Object,"function"==typeof(ue=void 0!==h.l&&h.l)?ue:Object])],de);let ye=class{constructor(t,e,n,i,o,r){this.logger=t,this.httpClient=e,this.skin=n,this.window=i,this.wikiConfig=o,this.geo=r,this.dataWarehouseUrl="https://beacon.wikia-services.com/__track/special/adengloadtimes",this.initStartTime()}getTimeOrigin(){var t;return null===(t=window.performance)||void 0===t?void 0:t.timeOrigin}getCurrentTimestamp(){return Date.now()}initStartTime(){const t=new Date;this.startTime||(this.startTime=this.getTimeOrigin(),this.tzOffset=t.getTimezoneOffset())}getStartTime(){return this.startTime}getTimezoneOffset(){return this.tzOffset}send(t){this.sendEvent(t,this.dataWarehouseUrl)}sendEvent(t,e){const n=Object.assign(Object.assign({event_name:t,load_time:this.getCurrentTimestamp()-this.getStartTime()},this.getTimeBasedParams()),this.getTrackingParams()),i=this.buildDataWarehouseUrl(n,e);i&&this.httpClient.get(i)}getTrackingParams(){var t,e,n,i,o,r,s,a,c,u,d,l,f;return{browser_ts:this.getCurrentTimestamp(),tz_offset:this.getTimezoneOffset(),country:this.geo.getCountryCode()||"",session_id:null===(e=null===(t=this.window.fandomContext)||void 0===t?void 0:t.tracking)||void 0===e?void 0:e.sessionId,pv_number:null===(i=null===(n=this.window.fandomContext)||void 0===n?void 0:n.tracking)||void 0===i?void 0:i.pvNumber,pv_number_global:null===(r=null===(o=this.window.fandomContext)||void 0===o?void 0:o.tracking)||void 0===r?void 0:r.pvNumberGlobal,pv_unique_id:null===(a=null===(s=this.window.fandomContext)||void 0===s?void 0:s.tracking)||void 0===a?void 0:a.pvUID,beacon:null===(u=null===(c=this.window.fandomContext)||void 0===c?void 0:c.tracking)||void 0===u?void 0:u.beaconId,u:-1,ua:null===(d=this.window.navigator)||void 0===d?void 0:d.userAgent,c:this.wikiConfig.get("wgCityId")||"unknown",ck:this.wikiConfig.get("dsSiteKey")||"unknown",lc:this.wikiConfig.get("wgUserLanguage")||"unknown",s:this.skin.get(),a:(null===(f=null===(l=this.window.fandomContext)||void 0===l?void 0:l.page)||void 0===f?void 0:f.articleId)||-1,x:this.wikiConfig.get("wgDBname")||"unknown",n:this.wikiConfig.get("wgNamespaceNumber")||-1}}getTimeBasedParams(){return{cb:Math.floor(99999*Math.random()),url:document.URL}}buildDataWarehouseUrl(t,e){if(!e)return void this.logger.error("Error building DWH tracking URL");const n=new URLSearchParams(t);return n.sort(),`${e}?${n.toString()}`}};var me,we,be;ye=(0,t.gn)([(0,e.b2)(),(0,t.fM)(0,(0,e.XH)(d.Y,d.d,"DataWarehouseService")),(0,t.fM)(1,(0,e.f3)(l)),(0,t.fM)(2,(0,e.f3)(ne)),(0,t.fM)(3,(0,e.f3)(f.m9)),(0,t.fM)(4,(0,e.f3)(E)),(0,t.fM)(5,(0,e.f3)(h.l)),(0,t.w6)("design:paramtypes",["function"==typeof(le=void 0!==d.Y&&d.Y)?le:Object,"function"==typeof(fe=void 0!==l&&l)?fe:Object,"function"==typeof(he=void 0!==ne&&ne)?he:Object,"function"==typeof(pe="undefined"!=typeof Window&&Window)?pe:Object,"function"==typeof(ge=void 0!==E&&E)?ge:Object,"function"==typeof(ve=void 0!==h.l&&h.l)?ve:Object])],ye);let Ce=class{constructor(t,e,n){this.logger=t,this.identityEventSender=e,this.loadTimeEventSender=n}track(t,e){switch(t){case Zt.identity:this.identityEventSender.send(e);break;case Zt.loadTime:this.loadTimeEventSender.send(e);break;default:this.logger.info("Invalid event type to track")}}};var ke,Se,Oe;Ce=(0,t.gn)([(0,e.b2)(),(0,t.fM)(0,(0,e.XH)(d.Y,d.d,"DataWarehouseService")),(0,t.fM)(1,(0,e.f3)(de)),(0,t.fM)(2,(0,e.f3)(ye)),(0,t.w6)("design:paramtypes",["function"==typeof(me=void 0!==d.Y&&d.Y)?me:Object,"function"==typeof(we=void 0!==de&&de)?we:Object,"function"==typeof(be=void 0!==ye&&ye)?be:Object])],Ce);let _e=class{constructor(t,e,n){this.dataWarehouse=t,this.window=e,this.logger=n}activateTracking(){if(!this.isEnabled())return void this.logger.info("Hem Tracking is disabled");const t=this.extractHEMs();Object.keys(t).forEach((e=>{t[e]&&this.dataWarehouse.track(Zt.identity,{partner_name:"MediaWiki-"+e,partner_identity_id:t[e]})}))}isEnabled(){var t,e,n;return(null===(n=null===(e=null===(t=this.window.ads)||void 0===t?void 0:t.context)||void 0===e?void 0:e.opts)||void 0===n?void 0:n.userEmailHashes)&&this.window.ads.context.opts.userEmailHashes.length>0}extractHEMs(){const[t,e,n]=this.window.ads.context.opts.userEmailHashes;return{md5:t,sha1:e,sha256:n}}};var Me;_e=(0,t.gn)([(0,e.b2)(),(0,t.fM)(0,(0,e.f3)(Ce)),(0,t.fM)(1,(0,e.f3)(f.m9)),(0,t.fM)(2,(0,e.XH)(d.Y,d.d,"HemTracking")),(0,t.w6)("design:paramtypes",["function"==typeof(ke=void 0!==Ce&&Ce)?ke:Object,"function"==typeof(Se="undefined"!=typeof Window&&Window)?Se:Object,"function"==typeof(Oe=void 0!==d.Y&&d.Y)?Oe:Object])],_e);let je=class{constructor(t){this.window=t}get(t){return this.window.fandomContext.tracking[t]}set(t,e){this.window.fandomContext&&this.window.fandomContext.tracking||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{tracking:{}})),this.window.fandomContext.tracking[t]=e.value}remove(t){try{delete this.window.fandomContext.tracking[t]}catch(t){}}};var Ie;je=(0,t.gn)([(0,e.b2)(),(0,t.fM)(0,(0,e.f3)(f.m9)),(0,t.w6)("design:paramtypes",["function"==typeof(Me="undefined"!=typeof Window&&Window)?Me:Object])],je);let Te=class{constructor(t){this.cookiesManager=t}get(t){return this.cookiesManager.get(t)}set(t,e){const{value:n,domain:i,expiresMS:o}=e,r=new Date((new Date).getTime()+o);this.cookiesManager.set(t,n.toString(),{domain:i,expires:r})}remove(t){this.cookiesManager.remove(t)}};Te=(0,t.gn)([(0,e.b2)(),(0,t.fM)(0,(0,e.f3)(f.E9)),(0,t.w6)("design:paramtypes",["function"==typeof(Ie="undefined"!=typeof CookiesManager&&CookiesManager)?Ie:Object])],Te);let Ee=class{generate(){let t="";for(;t.length<10;)t+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-"[64*Math.random()|0];return t}};var xe;Ee=(0,t.gn)([(0,e.b2)()],Ee);let Pe=class{constructor(t){this.cookiesManager=t}getNextNumberFromCookie(t){const e=parseInt(this.cookiesManager.get(t));return Number.isNaN(e)?1:e+1}};var Re,De,Le,Ae,Ne,Ge,Ue;Pe=(0,t.gn)([(0,e.b2)(),(0,t.fM)(0,(0,e.f3)(f.E9)),(0,t.w6)("design:paramtypes",["function"==typeof(xe="undefined"!=typeof CookiesManager&&CookiesManager)?xe:Object])],Pe);const We=18e5;let Ye=class{constructor(t,e,n,i,o,r,s,a){this.windowRepository=t,this.cookieRepository=e,this.uuid=n,this.beaconGenerator=i,this.pageViewNumberGenerator=o,this.window=r,this.wikiConfig=s,this.communicationService=a,this.communicationService.on(M,(()=>{this.updatePageViewData()}))}set(t,e){this.windowRepository.set(t,e),this.cookieRepository.set(t,e)}remove(t){this.windowRepository.remove(t),this.cookieRepository.remove(t)}updatePageViewData(){const t=this.window.location.hostname,e=T.r.extract(t);this.windowRepository.set("pvUID",{domain:t,expiresMS:We,value:this.wikiConfig.get("pvUID")||this.window.pvUID||this.uuid()}),this.set("pvNumber",{domain:t,expiresMS:We,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumber")}),this.set("pvNumberGlobal",{domain:e,expiresMS:We,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumberGlobal")})}updateUserTrackingData(){const t=this.window.location.hostname,e=T.r.extract(t),n={domain:e,expiresMS:15552e6,value:this.cookieRepository.get("wikia_beacon_id")||this.cookieRepository.get("beaconId")||this.beaconGenerator.generate()};this.windowRepository.set("beaconId",n),this.cookieRepository.set("wikia_beacon_id",n);const i=this.wikiConfig.get("sessionId",this.window.sessionId)||this.cookieRepository.get("sessionId"),o={domain:e,expiresMS:We,value:i||this.uuid()};this.set("sessionId",o)}setup(){this.updateUserTrackingData(),this.updatePageViewData()}clear(){this.remove("beaconId"),this.remove("sessionId"),this.remove("pvNumber"),this.remove("pvNumberGlobal")}};Ye=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(je)),(0,t.fM)(1,(0,e.f3)(Te)),(0,t.fM)(2,(0,e.f3)(f.hb)),(0,t.fM)(3,(0,e.f3)(Ee)),(0,t.fM)(4,(0,e.f3)(Pe)),(0,t.fM)(5,(0,e.f3)(f.m9)),(0,t.fM)(6,(0,e.f3)(E)),(0,t.fM)(7,(0,e.f3)(it)),(0,t.w6)("design:paramtypes",["function"==typeof(Re=void 0!==je&&je)?Re:Object,"function"==typeof(De=void 0!==Te&&Te)?De:Object,Function,"function"==typeof(Le=void 0!==Ee&&Ee)?Le:Object,"function"==typeof(Ae=void 0!==Pe&&Pe)?Ae:Object,"function"==typeof(Ne="undefined"!=typeof Window&&Window)?Ne:Object,"function"==typeof(Ge=void 0!==E&&E)?Ge:Object,"function"==typeof(Ue=void 0!==it&&it)?Ue:Object])],Ye);var He,$e=o(518);class Fe{constructor(t){this.options=t,this.tags={},this.errorQueue=[]}get inserted(){return Array.from(document.getElementsByTagName("script")).some((t=>t.src===Fe.SENTRY_SCRIPT_CDN_URL))}get shouldLoad(){return Math.random()<this.options.sampleRate&&void 0!==Fe.ALLOWED_URLS.find((t=>window.location.hostname.includes(t)))}get loaded(){return void 0!==window.Sentry}get initialized(){return void 0!==this.hub}setTags(t){this.tags=t}captureException(t){if(console.error(`[IE] (${this.options.release} ${this.options.environment}) Error captured:`,t),"development"!==this.options.environment&&this.shouldLoad){if(!this.inserted)return this.errorQueue.push(t),void this.loadSentry();if(!this.loaded)return this.errorQueue.push(t),void(0,$e.X)((()=>this.loaded),10,100).then((()=>{this.createSentryInstance(),this.flushErrorQueue()}));this.initialized||this.createSentryInstance(),this.hub.captureException(t)}}loadSentry(){return new Promise((t=>{const e=document.createElement("script");e.defer=!0,e.src=Fe.SENTRY_SCRIPT_CDN_URL,e.crossOrigin="anonymous",e.integrity=Fe.SENTRY_SCRIPT_INTEGRITY,e.onload=()=>{this.createSentryInstance(),this.flushErrorQueue(),t()},document.getElementsByTagName("script")[0].parentNode.append(e)}))}createSentryInstance(){const{Breadcrumbs:t,BrowserClient:e,Dedupe:n,defaultStackParser:i,HttpContext:o,Hub:r,LinkedErrors:s,makeFetchTransport:a}=window.Sentry,c=new e(Object.assign(Object.assign({},this.options),{sampleRate:1,transport:a,stackParser:i,integrations:[new t,new n,new o,new s]}));this.hub=new r(c),this.hub.setTags(Object.assign({url:window.location.href,userAgent:window.navigator.userAgent},this.tags))}flushErrorQueue(){this.errorQueue.forEach((t=>{var e;return null===(e=this.hub)||void 0===e?void 0:e.captureException(t)}))}}Fe.ALLOWED_URLS=["fandom.com","futhead.com","gamespot.com","giantbomb.com","metacritic.com","muthead.com","tvguide.com"],Fe.SENTRY_SCRIPT_CDN_URL="//browser.sentry-cdn.com/7.55.2/bundle.min.js",Fe.SENTRY_SCRIPT_INTEGRITY="sha384-grzsqzUax9BbmJWNgYTLmejARf1orUEVEvvg2sXJ60jMyjmzW/Eh8hrCFkSu6GNm";let Ve=class{constructor(t){this.sentry=t}resolve(t,e,n){var i;t.geoRequiresConsent&&t.gdprConsent||t.geoRequiresSignal&&!t.ccpaSignal||!t.geoRequiresSignal&&!t.geoRequiresConsent?(this.consentGiven=!0,null===(i=e())||void 0===i||i.catch((t=>this.sentry.captureException(t)))):(t.geoRequiresSignal&&t.ccpaSignal||t.geoRequiresConsent&&!t.gdprConsent)&&(this.consentGiven=!1,n())}getConsents(){return this.consentGiven}};var Be,ze;Ve=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(f.Nm)),(0,t.w6)("design:paramtypes",["function"==typeof(He=void 0!==Fe&&Fe)?He:Object])],Ve),function(t){t.LOCAL="local",t.IDENTITY_STORAGE="identity_storage"}(Be||(Be={}));let qe=class{constructor(t){this.window=t}getItem(t){let e=null;try{return e=this.window.localStorage.getItem(t),JSON.parse(e)}catch(t){return e}}setItem(t,e){const n=e instanceof Object?JSON.stringify(e):e;try{this.window.localStorage.setItem(t,n)}catch(t){}}removeItem(t){return this.window.localStorage.removeItem(t)}};var Xe,Ke,Je;qe=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(f.m9)),(0,t.w6)("design:paramtypes",["function"==typeof(ze="undefined"!=typeof Window&&Window)?ze:Object])],qe);let Qe=class{constructor(t,e,n,i){this.logger=t,this.uuid=e,this.storage=n,this.serviceBaseUrl=i,this.logGroup="identity-storage",this.IdentityStorageKey="identity",this.ISUrl=this.serviceBaseUrl.get()+"identity-storage/"}fetchData(){return(0,t.mG)(this,void 0,void 0,(function*(){const t=new AbortController,e=setTimeout((()=>t.abort()),1e3);return fetch(this.ISUrl,{mode:"cors",credentials:"include",signal:t.signal}).then((t=>(clearTimeout(e),200===t.status||202===t.status?t.json():this.createFallbackResponse()))).catch((t=>(this.logger.info(this.logGroup,"Loading Identity LocalStorage data failed",t),this.createFallbackResponse())))}))}postData(e){return(0,t.mG)(this,void 0,void 0,(function*(){return fetch(this.ISUrl+"identity",{credentials:"include",mode:"cors",headers:{"Content-Type":"application/json"},method:"PUT",body:JSON.stringify({ppid:e.ppid})}).then((t=>t.json()))}))}getLocalData(){return this.storage.getItem(this.IdentityStorageKey)}setLocalData(t){this.storage.setItem(this.IdentityStorageKey,t)}createFallbackResponse(){return{timestamp:Date.now(),over18:!1,synced:!1,ppid:this.uuid()}}};var Ze,tn,en,nn,on;Qe=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.XH)(d.Y,d.d,"UserIdentity")),(0,t.fM)(1,(0,e.f3)(f.hb)),(0,t.fM)(2,(0,e.f3)(qe)),(0,t.fM)(3,(0,e.f3)(p)),(0,t.w6)("design:paramtypes",["function"==typeof(Xe=void 0!==d.Y&&d.Y)?Xe:Object,Function,"function"==typeof(Ke=void 0!==qe&&qe)?Ke:Object,"function"==typeof(Je=void 0!==p&&p)?Je:Object])],Qe);let rn=class{constructor(t,e,n,i,o){this.storage=t,this.logger=e,this.windowContextRepository=n,this.instantConfigService=i,this.identityStorageClient=o}get(){return(0,t.mG)(this,void 0,void 0,(function*(){const t=yield this.getLocalData();return t&&!t.synced&&this.setRemote(t),!t||this.isDeprecated(t)?this.getRemote():(this.setIdentityContextVariables(t),t)}))}setRemote(e){return(0,t.mG)(this,void 0,void 0,(function*(){try{yield this.identityStorageClient.postData(e);const t=Object.assign(Object.assign({},this.identityStorageClient.getLocalData()),{synced:!0});return this.setIdentityContextVariables(t),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},t),{timestamp:Date.now()})),t}catch(t){this.logger.error("Updating Identity LocalStorage data failed")}}))}isDeprecated(t){const e=this.instantConfigService.get("icIdentityTtl",6048e5),n=Date.now()-e;return!t.timestamp||t.timestamp-n<0}getLocalData(){return(0,t.mG)(this,void 0,void 0,(function*(){let t=yield this.identityStorageClient.getLocalData();if(!t){const e=this.getLocalPPID()||this.getAdmsPPID();e&&(t=yield this.migrateDeprecatedIdentity(e))}return t}))}migrateDeprecatedIdentity(e){return(0,t.mG)(this,void 0,void 0,(function*(){const t=yield this.setRemote({ppid:e,synced:!1});return this.clearDeprecatedLocalPpid(),t}))}getAdmsPPID(){var t,e;const n=this.storage.getItem("silver-surfer-active-data-v2");return null===(e=null===(t=null==n?void 0:n.IDENTITY)||void 0===t?void 0:t[0].payload)||void 0===e?void 0:e.identityToken}getLocalPPID(){return this.storage.getItem("ppid")}clearDeprecatedLocalPpid(){this.storage.removeItem("ppid")}getRemote(){return(0,t.mG)(this,void 0,void 0,(function*(){const t=yield this.identityStorageClient.fetchData();return this.setIdentityContextVariables(t),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},t),{timestamp:Date.now()})),t}))}setIdentityContextVariables(t){t.over18&&this.windowContextRepository.set("over_18",{value:"1"})}};var sn,an;rn=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(qe)),(0,t.fM)(1,(0,e.XH)(d.Y,d.d,"UserIdentity")),(0,t.fM)(2,(0,e.f3)(je)),(0,t.fM)(3,(0,e.f3)(Lt)),(0,t.fM)(4,(0,e.f3)(Qe)),(0,t.w6)("design:paramtypes",["function"==typeof(Ze=void 0!==qe&&qe)?Ze:Object,"function"==typeof(tn=void 0!==d.Y&&d.Y)?tn:Object,"function"==typeof(en=void 0!==je&&je)?en:Object,"function"==typeof(nn=void 0!==Lt&&Lt)?nn:Object,"function"==typeof(on=void 0!==Qe&&Qe)?on:Object])],rn);let cn=class{constructor(t,e){this.logger=t,this.identityStorageService=e}get(){return(0,t.mG)(this,void 0,void 0,(function*(){const t=yield this.identityStorageService.get();return this.logger.info(t),t.ppid}))}};var un,dn;cn=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.XH)(d.Y,d.d,"UserIdentity")),(0,t.fM)(1,(0,e.f3)(rn)),(0,t.w6)("design:paramtypes",["function"==typeof(sn=void 0!==d.Y&&d.Y)?sn:Object,"function"==typeof(an=void 0!==rn&&rn)?an:Object])],cn);let ln=class{constructor(t,e,n){this.logger=t,this.uuid=e,this.storage=n}get(){return Promise.resolve(this.storage.getItem("ppid")||this.generatePPID())}generatePPID(){this.logger.info("did not found a PPID in LocalStorage");const t=this.uuid();return this.storage.setItem("ppid",t),t}};var fn,hn,pn,gn,vn,yn,mn;ln=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.XH)(d.Y,d.d,"UserIdentity")),(0,t.fM)(1,(0,e.f3)(f.hb)),(0,t.fM)(2,(0,e.f3)(qe)),(0,t.w6)("design:paramtypes",["function"==typeof(un=void 0!==d.Y&&d.Y)?un:Object,Function,"function"==typeof(dn=void 0!==qe&&qe)?dn:Object])],ln);let wn=class{constructor(t,e,n,i,o,r,s){this.dataWarehouse=t,this.logger=e,this.windowContextRepository=n,this.instantConfigService=i,this.identityStorageRepository=o,this.localStorageRepository=r,this.communicationService=s}getPPID(t){switch(this.logger.info("active strategy: ",t),t){case Be.IDENTITY_STORAGE:return this.identityStorageRepository;case Be.LOCAL:default:return this.localStorageRepository}}generatePPID(){return(0,t.mG)(this,void 0,void 0,(function*(){try{const t=this.instantConfigService.get("icPpidRepository",Be.LOCAL),e=yield this.getPPID(t).get();this.dataWarehouse.track(Zt.identity,{partner_name:"Google",partner_identity_id:e}),this.communicationService.emit(new C(O,{payload:{partnerName:"Google",partnerIdentityId:e}})),this.windowContextRepository.set("ppid",{value:e}),this.logger.info("Passed PPID to page-level targeting")}catch(t){this.logger.error("Setting up PPID has failed!",t)}}))}setPpid(){return(0,t.mG)(this,void 0,void 0,(function*(){this.instantConfigService.get("icPpid",!1)?(this.logger.info("enabled - awaiting setup"),yield this.generatePPID()):this.logger.info("disabled")}))}};var bn,Cn,kn,Sn;wn=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(Ce)),(0,t.fM)(1,(0,e.XH)(d.Y,d.d,"UserIdentity")),(0,t.fM)(2,(0,e.f3)(je)),(0,t.fM)(3,(0,e.f3)(Lt)),(0,t.fM)(4,(0,e.f3)(cn)),(0,t.fM)(5,(0,e.f3)(ln)),(0,t.fM)(6,(0,e.f3)(it)),(0,t.w6)("design:paramtypes",["function"==typeof(fn=void 0!==Ce&&Ce)?fn:Object,"function"==typeof(hn=void 0!==d.Y&&d.Y)?hn:Object,"function"==typeof(pn=void 0!==je&&je)?pn:Object,"function"==typeof(gn=void 0!==Lt&&Lt)?gn:Object,"function"==typeof(vn=void 0!==cn&&cn)?vn:Object,"function"==typeof(yn=void 0!==ln&&ln)?yn:Object,"function"==typeof(mn=void 0!==it&&it)?mn:Object])],wn);let On=class{constructor(t,e,n,i){this.window=t,this.logger=e,this.context=n,this.cookieRepository=i,this.createPartnersContext()}createPartnersContext(){this.window.fandomContext&&this.window.fandomContext.partners||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{partners:{}}))}setIsCoppaSubjectInContext(t){this.coppaSubject=t,this.window.fandomContext.partners.directedAtChildren=t,this.window.fandomContext.partners.blockthrough={directedAtChildren:t}}isCoppaSubject(){return void 0===this.coppaSubject?this.resolveCoppaStatus():this.coppaSubject}resolveCoppaStatus(){var t,e;if(!Boolean(null===(e=null===(t=this.context.get())||void 0===t?void 0:t.targeting)||void 0===e?void 0:e.directedAtChildren))return this.setIsCoppaSubjectInContext(!1),!1;try{const t="1"!==this.cookieRepository.get("ag");return this.setIsCoppaSubjectInContext(t),t}catch(t){this.logger.error("Error while reading age gate cookie")}}};var _n,Mn,jn,In;On=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(f.m9)),(0,t.fM)(1,(0,e.XH)(d.Y,d.d,"CoppaSubject")),(0,t.fM)(2,(0,e.f3)(P)),(0,t.fM)(3,(0,e.f3)(Te)),(0,t.w6)("design:paramtypes",["function"==typeof(bn="undefined"!=typeof Window&&Window)?bn:Object,"function"==typeof(Cn=void 0!==d.Y&&d.Y)?Cn:Object,"function"==typeof(kn=void 0!==P&&P)?kn:Object,"function"==typeof(Sn=void 0!==Te&&Te)?Sn:Object])],On);let Tn=class{constructor(t,e,n,i){this.platform=e,this.window=n,this.logger=i,this.enabled=!1,this.endpoint=`${t.get()}adeng/api/identity/metrics`}init(t){var e;const n=t.get("icMonitorTrafficThreshold",{identity:0});var i;this.enabled="object"==typeof(i=n)&&!Array.isArray(i)&&null!==i&&(null==n?void 0:n.identity)>0&&n.identity>=100*Math.random(),this.logger.info(`Metric reporter enabled: ${this.enabled}, threshold:`,n),this.enabled&&("complete"===this.window.document.readyState?this.sendPerformanceMetrics():null===(e=this.window)||void 0===e||e.addEventListener("load",(()=>this.sendPerformanceMetrics())))}send(t,e=0){if(!this.enabled)return;const n=new URL(this.endpoint);n.searchParams.set("app",this.platform.get()),n.searchParams.set("action",t);const i=e>0?e:this.logger.getTimeDelta();n.searchParams.set("duration",Math.round(i).toString()),fetch(n,{mode:"no-cors"})}sendPerformanceMetrics(){const t=this.window.performance.getEntriesByType("navigation");t.length>0&&(this.send("document_content_loaded",t[0].domContentLoadedEventEnd),this.send("document_load_time",t[0].loadEventEnd))}};var En;Tn=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(p)),(0,t.fM)(1,(0,e.f3)(Mt)),(0,t.fM)(2,(0,e.f3)(f.m9)),(0,t.fM)(3,(0,e.XH)(d.Y,d.d,"MetricReporterService")),(0,t.w6)("design:paramtypes",["function"==typeof(_n=void 0!==p&&p)?_n:Object,"function"==typeof(Mn=void 0!==Mt&&Mt)?Mn:Object,"function"==typeof(jn="undefined"!=typeof Window&&Window)?jn:Object,"function"==typeof(In=void 0!==d.Y&&d.Y)?In:Object])],Tn);let xn=class{constructor(t){this.window=t}getItem(t){const e=this.window.sessionStorage.getItem(t);try{return JSON.parse(e)}catch(t){return e}}setItem(t,e){const n=e instanceof Object?JSON.stringify(e):e;this.window.sessionStorage.setItem(t,n)}removeItem(t){return this.window.sessionStorage.removeItem(t)}};xn=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(f.m9)),(0,t.w6)("design:paramtypes",["function"==typeof(En="undefined"!=typeof Window&&Window)?En:Object])],xn);var Pn,Rn,Dn,Ln,An,Nn,Gn,Un=o(604);let Wn=class{constructor(t,e,n,i,o,r,s){this.assetLoader=t,this.consentResolver=e,this.instantConfigService=n,this.coppaSubject=i,this.dataWarehouse=o,this.logger=r,this.metricReporter=s,this.partnerName="liveConnect",this.liveConnectScriptUrl="https://b-code.liadm.com/a-07ev.min.js",this.fallbackQf="0.3",this.live_connect_tracking_events={LIVE_CONNECT_STARTED:"live_connect_started",LIVE_CONNECT_CACHED:"live_connect_cached",LIVE_CONNECT_RESPONDED_UUID:"live_connect_responded_uuid"},this.idConfigMapping=[{id:"unifiedId",name:`${this.partnerName}-unifiedId`},{id:"sha2",name:this.partnerName,params:{qf:"0.3",resolve:"sha2"}},{id:"md5",name:`${this.partnerName}-md5`,params:{qf:"0.3",resolve:"md5"}},{id:"sha1",name:`${this.partnerName}-sha1`,params:{qf:"0.3",resolve:"sha1"}}]}isEnabled(){return this.consentResolver.getConsents()&&this.instantConfigService.get("icLiveConnect")&&this.instantConfigService.get("icLiveConnectCachingStrategy")&&this.instantConfigService.get("icIdentityPartners")&&!this.coppaSubject.isCoppaSubject()}init(){return(0,t.mG)(this,void 0,void 0,(function*(){this.isEnabled()?(this.setupStorage(),this.shouldLoadScript()?(this.logger.info("loading"),this.dataWarehouse.track(Zt.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_STARTED),this.assetLoader.loadScript(this.liveConnectScriptUrl,"text/javascript",!1).then((()=>{this.logger.info("loaded"),this.resolveAndTrackIds(),this.logEvent("live-connect-requested")}))):(this.dataWarehouse.track(Zt.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_CACHED),this.logger.info(`already loaded and available in ${this.storageConfig.type}Storage`))):this.logger.info("disabled")}))}resolveAndTrackIds(){var t;if(!window.liQ)return void this.logger.warn("window.liQ not available for tracking");const e=null===(t=this.instantConfigService.get("icLiveConnectQf"))||void 0===t?void 0:t.toString();window.liQ.resolve((t=>{this.trackIds(t)}),(t=>{console.error(t)}),{qf:e||this.fallbackQf,resolve:this.idConfigMapping.map((t=>t.id))})}trackIds(t){this.logger.info("resolve response:",t),Object.keys(t).forEach((e=>{if(!t[e])return;const n=this.getTrackingKeyName(e);if(this.isAvailableInStorage(n))return;"unifiedId"===e&&this.dataWarehouse.track(Zt.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_RESPONDED_UUID);const i=t[e];this.logger.info(`${e}: ${i}`),i&&(this.storage.setItem(n,i,this.storageConfig.ttl),this.dataWarehouse.track(Zt.identity,{partner_name:n,partner_identity_id:i}))}))}getTrackingKeyName(t){var e;return null===(e=this.idConfigMapping.find((e=>e.id===t)))||void 0===e?void 0:e.name}setupStorage(){this.storageConfig=this.instantConfigService.get("icLiveConnectCachingStrategy"),"local"===this.storageConfig.type?this.storage=e.nC.resolve(qe):this.storage=e.nC.resolve(xn)}shouldLoadScript(){var t;if(!this.storageConfig)return!0;let e=!1;for(const n of this.storageConfig.mandatoryParams){const i=null===(t=this.idConfigMapping.find((t=>t.id===n)))||void 0===t?void 0:t.name;if(!this.isAvailableInStorage(i)){e=!0;break}}return e}isAvailableInStorage(t){return!!this.storage.getItem(t)}logEvent(t){this.metricReporter.send(t,1)}};var Yn,Hn;Wn=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(Un.g)),(0,t.fM)(1,(0,e.f3)((0,e.gw)((()=>Ve)))),(0,t.fM)(2,(0,e.f3)((0,e.gw)((()=>Lt)))),(0,t.fM)(3,(0,e.f3)(On)),(0,t.fM)(4,(0,e.f3)(Ce)),(0,t.fM)(5,(0,e.XH)(d.Y,d.d,"liveConnect")),(0,t.fM)(6,(0,e.f3)(Tn)),(0,t.w6)("design:paramtypes",["function"==typeof(Pn=void 0!==Un.g&&Un.g)?Pn:Object,"function"==typeof(Rn=void 0!==Ve&&Ve)?Rn:Object,"function"==typeof(Dn=void 0!==Lt&&Lt)?Dn:Object,"function"==typeof(Ln=void 0!==On&&On)?Ln:Object,"function"==typeof(An=void 0!==Ce&&Ce)?An:Object,"function"==typeof(Nn=void 0!==d.Y&&d.Y)?Nn:Object,"function"==typeof(Gn=void 0!==Tn&&Tn)?Gn:Object])],Wn);let $n=class{constructor(t,e){this.logger=t,this.liveConnect=e}initializeTargetingPartners(){return(0,t.mG)(this,void 0,void 0,(function*(){}))}initializeTrackingPartners(){return(0,t.mG)(this,void 0,void 0,(function*(){this.logger.info("Initializing partners"),yield Promise.all([this.liveConnect.init()])}))}};var Fn,Vn,Bn,zn;$n=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.XH)(d.Y,d.d,"Partners")),(0,t.fM)(1,(0,e.f3)(Wn)),(0,t.w6)("design:paramtypes",["function"==typeof(Yn=void 0!==d.Y&&d.Y)?Yn:Object,"function"==typeof(Hn=void 0!==Wn&&Wn)?Hn:Object])],$n);let qn=class{constructor(t,e,n,i){this.sentry=t,this.browser=e,this.device=n,this.platform=i,this.sentry.setTags({browser:this.browser.getBrowser(),device:this.device.getDeviceType(),platform:this.platform.get()})}};var Xn,Kn,Jn,Qn,Zn,ti,ei,ni,ii,oi,ri,si,ai,ci;qn=(0,t.gn)([(0,e.b2)(),(0,t.fM)(0,(0,e.f3)(f.Nm)),(0,t.fM)(1,(0,e.f3)(_t)),(0,t.fM)(2,(0,e.f3)(Ot)),(0,t.fM)(3,(0,e.f3)(Mt)),(0,t.w6)("design:paramtypes",["function"==typeof(Fn=void 0!==Fe&&Fe)?Fn:Object,"function"==typeof(Vn=void 0!==_t&&_t)?Vn:Object,"function"==typeof(Bn=void 0!==Ot&&Ot)?Bn:Object,"function"==typeof(zn=void 0!==Mt&&Mt)?zn:Object])],qn),o(155),e.nC.register(f.E9,{useValue:i}),e.nC.register(f.hb,{useValue:function(t,e,n){if(r.randomUUID&&!e&&!t)return r.randomUUID();const i=(t=t||{}).random||(t.rng||c)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){n=n||0;for(let t=0;t<16;++t)e[n+t]=i[t];return e}return function(t,e=0){return(u[t[e+0]]+u[t[e+1]]+u[t[e+2]]+u[t[e+3]]+"-"+u[t[e+4]]+u[t[e+5]]+"-"+u[t[e+6]]+u[t[e+7]]+"-"+u[t[e+8]]+u[t[e+9]]+"-"+u[t[e+10]]+u[t[e+11]]+u[t[e+12]]+u[t[e+13]]+u[t[e+14]]+u[t[e+15]]).toLowerCase()}(i)}}),e.nC.register(f.m9,{useValue:window});let ui=class{constructor(t,e,n,i,o,r,s,a,c,u,d,l,f,h){this.geoCookie=t,this.ageGateHandler=e,this.communicationService=n,this.optInService=i,this.hemTrackingService=o,this.trackingContextSetupService=r,this.consentResolver=s,this.instantConfigService=a,this.window=c,this.logger=u,this.ppidProvider=d,this.coppaSubject=l,this.metricReporterService=f,this.partnersService=h}initializeAgeGateHandler(){return(0,t.mG)(this,void 0,void 0,(function*(){return this.ageGateHandler.init(this.communicationService)}))}updateGTMConsent(t){void 0===this.window.dataLayer&&(this.window.dataLayer=[]),this.window.dataLayer.push({event:"user-consent",consent:t.toString()})}initializeTracking(){return(0,t.mG)(this,void 0,void 0,(function*(){this.logger.info("Setting up tracking"),this.optInService.trackingAllowed=!0,this.hemTrackingService.activateTracking(),yield this.ppidProvider.setPpid(),yield this.partnersService.initializeTrackingPartners(),this.communicationService.emit(new C(S)),this.metricReporterService.send("ready")}))}init(){return(0,t.mG)(this,void 0,void 0,(function*(){yield this.geoCookie.setGeoCookieIfNotExist(),yield this.instantConfigService.init(this.communicationService),this.optInService.init(),this.metricReporterService.init(this.instantConfigService),this.metricReporterService.send("init")}))}run(){this.logger.info("Starting identity engine v2.11.6"),this.communicationService.once(k,(e=>{this.trackingContextSetupService.setup(),this.consentResolver.resolve(e,(()=>(0,t.mG)(this,void 0,void 0,(function*(){this.updateGTMConsent(!0),this.partnersService.initializeTargetingPartners(),yield this.initializeAgeGateHandler(),this.coppaSubject.resolveCoppaStatus(),yield this.initializeTracking()}))),(()=>{this.updateGTMConsent(!1),this.partnersService.initializeTargetingPartners(),this.coppaSubject.resolveCoppaStatus(),this.optInService.trackingAllowed=!1,this.communicationService.emit(new C(S)),this.metricReporterService.send("ready"),this.logger.info("Tracking rejected")}))}))}};ui=(0,t.gn)([(0,e.ri)(),(0,t.fM)(0,(0,e.f3)(b)),(0,t.fM)(1,(0,e.f3)(G)),(0,t.fM)(2,(0,e.f3)(it)),(0,t.fM)(3,(0,e.f3)(Qt)),(0,t.fM)(4,(0,e.f3)(_e)),(0,t.fM)(5,(0,e.f3)(Ye)),(0,t.fM)(6,(0,e.f3)(Ve)),(0,t.fM)(7,(0,e.f3)(Lt)),(0,t.fM)(8,(0,e.f3)(f.m9)),(0,t.fM)(9,(0,e.XH)(d.Y,d.d,"IdentityEngine")),(0,t.fM)(10,(0,e.f3)(wn)),(0,t.fM)(11,(0,e.f3)(On)),(0,t.fM)(12,(0,e.f3)(Tn)),(0,t.fM)(13,(0,e.f3)($n)),(0,t.w6)("design:paramtypes",["function"==typeof(Xn=void 0!==b&&b)?Xn:Object,"function"==typeof(Kn=void 0!==G&&G)?Kn:Object,"function"==typeof(Jn=void 0!==it&&it)?Jn:Object,"function"==typeof(Qn=void 0!==Qt&&Qt)?Qn:Object,"function"==typeof(Zn=void 0!==_e&&_e)?Zn:Object,"function"==typeof(ti=void 0!==Ye&&Ye)?ti:Object,"function"==typeof(ei=void 0!==Ve&&Ve)?ei:Object,"function"==typeof(ni=void 0!==Lt&&Lt)?ni:Object,"function"==typeof(ii="undefined"!=typeof Window&&Window)?ii:Object,"function"==typeof(oi=void 0!==d.Y&&d.Y)?oi:Object,"function"==typeof(ri=void 0!==wn&&wn)?ri:Object,"function"==typeof(si=void 0!==On&&On)?si:Object,"function"==typeof(ai=void 0!==Tn&&Tn)?ai:Object,"function"==typeof(ci=void 0!==$n&&$n)?ci:Object])],ui),function(){(0,t.mG)(this,void 0,void 0,(function*(){const t=function(){try{return"US"===e.nC.resolve(h.l).get().country?.01:.1}catch(t){return.01}}(),n=new Fe({dsn:"https://3e92e20316cf4539a579d82f4294be77@o4504176096247808.ingest.sentry.io/4505432026447872",release:"2.11.6",environment:"production",sampleRate:t});try{e.nC.register(f.Nm,{useValue:n}),e.nC.resolve(qn);const t=e.nC.resolve(ui);yield t.init(),t.run()}catch(t){n.captureException(t)}}))}()})()})();
//# sourceMappingURL=index.js.map